(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/xGf":function(t,e,n){t.exports=n("4e1j")},"0N1A":function(t,e){var n,r,a,i,o,s,c,u,d,p,l,h,f,m,g,b=!1;function y(){if(!b){b=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),y=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(h=/\b(iPhone|iP[ao]d)/.exec(t),f=/\b(iP[ao]d)/.exec(t),p=/Android/i.exec(t),m=/FBAN\/\w+;/i.exec(t),g=/Mobile/i.exec(t),l=!!/Win64/.exec(t),e){(n=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN)&&document&&document.documentMode&&(n=document.documentMode);var v=/(?:Trident\/(\d+.\d+))/.exec(t);s=v?parseFloat(v[1])+4:n,r=e[2]?parseFloat(e[2]):NaN,a=e[3]?parseFloat(e[3]):NaN,(i=e[4]?parseFloat(e[4]):NaN)?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),o=e&&e[1]?parseFloat(e[1]):NaN):o=NaN}else n=r=a=o=i=NaN;if(y){if(y[1]){var O=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);c=!O||parseFloat(O[1].replace("_","."))}else c=!1;u=!!y[2],d=!!y[3]}else c=u=d=!1}}var v={ie:function(){return y()||n},ieCompatibilityMode:function(){return y()||s>n},ie64:function(){return v.ie()&&l},firefox:function(){return y()||r},opera:function(){return y()||a},webkit:function(){return y()||i},safari:function(){return v.webkit()},chrome:function(){return y()||o},windows:function(){return y()||u},osx:function(){return y()||c},linux:function(){return y()||d},iphone:function(){return y()||h},mobile:function(){return y()||h||f||p||g},nativeApp:function(){return y()||m},android:function(){return y()||p},ipad:function(){return y()||f}};t.exports=v},"0itG":function(t,e,n){"use strict";var r=n("D57K"),a=n("5xGT"),i=(n("hX56"),n("4y1S")),o=n("nsO7"),s=n("LiEJ"),c=n("gQst"),u=n("pN2L"),d=n("3riI"),p=n("AouM"),l=n("z5yO"),h=n("Jg5f"),f=n("lqvn"),m=n("D3kC"),g=n("c7W3"),b=(n("QoSw"),n("SBw3"),n("2m+3"),n("AaYA")),y=n("yhNa"),v=n("LC7v"),O=n("QCJn"),j=n("TQyE"),S=n("IGWl"),C=n("g3Dv"),I=n("fQLH"),D=n("cQOC"),x=n("NNJu"),P=n("U3QC"),w=n("12aA"),T=n("G2Mx"),E=n("myrl"),A=function(t){function e(e,n,r,a){var i=t.call(this,e,a)||this;return i.componentFactoryResolver=e,i.featureList=n,i.commandService=r,i.injector=a,i.items={},i.changeSubs={},i._change=new I.a,i.change.subscribe((function(t){return i.handleFeatureChange(t)})),i.resetOperations(),i}return r.d(e,t),Object.defineProperty(e.prototype,"change",{get:function(){return this._change.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemIds",{get:function(){return Object.keys(this.items)},enumerable:!0,configurable:!0}),e.prototype.addItem=function(t,e,n,r,a){var i=this.makeComponent(n);a&&i.instance.setProperties(a),i.instance.id=t,i.instance.setData(r),i.instance.apply(),this.operations.add.push({item:i,container:e})},e.prototype.removeItem=function(t){this.items[t]&&this.items[t].item&&this.operations.remove.push(t)},e.prototype.updateItem=function(t,e,n){if(this.items[t]&&this.items[t].item){var r=this.items[t].item;n&&r.instance.setProperties(n),r.instance.setData(e),this.operations.update.push(t)}},e.prototype.apply=function(t){var e=this,n=this.getPendingOperations(t);return n.length>0?D.a.apply(void 0,r.j(n)).pipe(Object(P.a)({complete:function(){e.resetOperations()}})):(this.resetOperations(),Object(u.a)({}))},e.prototype.getPendingOperations=function(t){var e=this,n=[];return this.operations.remove.length>0&&(n=n.concat(this.operations.remove.map((function(n){return e.removeFeatureItem(n,t)})))),this.operations.add.length>0&&(n=n.concat(this.operations.add.map((function(n){return e.insertFeatureItem(n.item,n.container,t)})))),this.operations.update.length>0&&(n=n.concat(this.operations.update.map((function(n){return e.updateFeatureItem(n,t)})))),n},e.prototype.insertFeatureItem=function(t,e,n){if(!this.items[t.instance.id]){if(this.items[t.instance.id]={item:t,container:e},this.subscribeToItemChange(t.instance),n){var r=this.getAddItemAnimation(t);return this.insert(e,t),t.changeDetectorRef.detectChanges(),r.start()}this.insert(e,t),t.changeDetectorRef.detectChanges()}return Object(u.a)({})},e.prototype.getItem=function(t){if(this.items&&this.items[t]){var e=this.items[t].item;if(e)return e.instance}},e.prototype.removeFeatureItem=function(t,e){var n=this;if(!this.items[t])return Object(u.a)({});var r=this.items[t].item,a=this.items[t].container;if(r){if(this.unsubscribeFromItemChange(t),e)return this.getRemoveItemAnimation(r).start().pipe(Object(P.a)({complete:function(){n.remove(a,r),delete n.items[t]}}));this.remove(a,r),delete this.items[t]}return Object(u.a)({})},e.prototype.updateFeatureItem=function(t,e){if(this.items[t]&&this.items[t].item){var n=this.items[t].item;if(e)return n.instance.applyAnimated();n.instance.apply()}return Object(u.a)({})},e.prototype.resetOperations=function(){this.operations={add:[],remove:[],update:[]}},e.prototype.subscribeToItemChange=function(t){var e=this,n=t.change.subscribe((function(n){return e._change.next({id:t.id,data:n})}));this.changeSubs[t.id]=n},e.prototype.unsubscribeFromItemChange=function(t){this.changeSubs[t]&&(this.changeSubs[t].unsubscribe(),delete this.changeSubs[t])},e.prototype.getAddItemAnimation=function(t){var e=new x.c({});return e.element=t.location.nativeElement,e},e.prototype.getRemoveItemAnimation=function(t){var e=new x.c({});return e.element=t.location.nativeElement,e},e.prototype.ngOnDestroy=function(){var t=this;Object.keys(this.changeSubs).forEach((function(e){t.changeSubs[e].unsubscribe()})),this._change.complete(),this.changeSubs=null,this.items=null,this.operations=null},e.prototype.renderFeatureChanges=function(t,e){var n=this;return this.features.pipe(Object(h.a)((function(e){return e.filter((function(e){return t.includes(e.featureId)}))})),Object(p.a)((function(r){return n.manage(t,r,e).pipe(Object(w.a)(r))})),Object(p.a)((function(t){return n.apply(!0).pipe(Object(w.a)(t))})))},e.prototype.manage=function(t,e,n){return Object(D.a)(this.removeComponents(t,e),this.updateComponents(e),this.addComponents(e,n)).pipe(Object(T.a)(1))},e.prototype.removeComponents=function(t,e){var n=this;return t.filter((function(t){return-1===e.map((function(t){return t.featureId})).indexOf(t)})).forEach((function(t){return n.removeItem(t)})),Object(u.a)({})},e.prototype.addComponents=function(t,e){var n=this,a=[];return t.forEach((function(t,r){-1===n.itemIds.indexOf(t.featureId)&&a.push(n.addComponent(t,e))})),Object(o.isEmpty)(a)?Object(u.a)({}):c.a.apply(void 0,r.j(a))},e.prototype.updateComponents=function(t){var e=this,n=[];return t.forEach((function(t,r){e.itemIds.includes(t.featureId)&&n.push(e.updateComponent(t))})),Object(o.isEmpty)(n)?Object(u.a)({}):c.a.apply(void 0,r.j(n))},e.prototype.updateComponent=function(t){var e=this,n=this.featureList.getFeature(t.featureId),r=this.getUIControlProperties(n);return this.getItemData(n,t.data).pipe(Object(h.a)((function(n){return e.updateItem(t.featureId,n,r)})))},e.prototype.addComponent=function(t,e){var n=this,r=this.featureList.getFeature(t.featureId),a=this.getUIControlType(r.dataType),i=this.getUIControlProperties(r);return this.getItemData(r,t.data).pipe(Object(h.a)((function(r){return n.addItem(t.featureId,e,a,r,i)})))},e.prototype.getUIControlProperties=function(t){return{id:t.id,icon:t.icon,label:t.label,labelPosition:t.labelPosition,dropdownDirection:t.dropdownDirection,tooltip:t.tooltip}},e.prototype.getUIControlType=function(t){if(!t||t===C.d.BINARY)return S.a;if(t===C.d.TEXT_POSITION)return b.a;if(t===C.d.OPTION_LIST_COMBO)return O.a;if(t===C.d.COLOR)return j.a;if(t===C.d.NUMBER)return y.a;if(t===C.d.OPTION_LIST)return v.a;if(t===C.d.CUSTOM_SHAPE_STYLE)return E.a;throw new Error("UI control is not available for "+t)},e.prototype.getItemData=function(t,e){return t.transformer?this.injector.get(t.transformer).getFeatureData(t.id,e):e?Object(u.a)(a.k.mergeInstances({},t.data,e)):Object(u.a)(t.data)},e.prototype.handleFeatureChange=function(t){var e=this,n=this.featureList.getFeature(t.id);if(n.transformer){this.injector.get(n.transformer).getApplyData(n.id,t.data).subscribe((function(t){e.commandService.dispatch(n.commandEvent,t)}))}else{var r=a.k.mergeInstances({},this.getCommandData(t.id),t.data);this.commandService.dispatch(n.commandEvent,r)}},e.prototype.getCommandData=function(t){var e={},n=this.getItem(t);return n&&n.data&&(n.data.dataItemId&&(e.dataItems=[{id:n.data.dataItemId,value:n.data.value}]),n.data.alterFunction&&(e.alterFunction=n.data.alterFunction)),e},e}(x.f);n.d(e,"a",(function(){return M}));var M=function(t){function e(e,n,r,a,i,o,c,u,d){var p=t.call(this,i,c,a,o)||this;return p.state=e,p.ll=n,p.gridService=r,p.commandService=a,p.componentFactoryResolver=i,p.injector=o,p.featureList=c,p.dataStore=u,p.translator=d,p.selectionXFeature=["selectionPositionX"],p.selectionYFeature=["selectionPositionY"],p.selectionWidthFeature=["selectionWidth"],p.selectionHeightFeature=["selectionHeight"],p.connectorStartXFeature=["connectorStartX"],p.connectorStartYFeature=["connectorStartY"],p.connectorEndXFeature=["connectorEndX"],p.connectorEndYFeature=["connectorEndY"],p.selectionAngleFeature=["selectionAngle"],p.textFeaturesBISU=["boldModelText","italicModelText","underlineModelText","strikeoutModelText"],p.textFeaturesAlign=["leftAlignModelText","centerAlignModelText","rightAlignModelText","justifyModelText"],p.textFeatureFont=["fontModelText"],p.textFeatureSize=["sizeModelText"],p.textFeatureColor=["colorModelText"],p.textFeatureTextPosition=["textPosition"],p.styleFeatureColor=["colorFill","colorLine","customShapeStyles"],p.styleFeatureLineStyle=["styleLine"],p.styleFeatureLineThickness=["lineThickness"],p.features=new s.a([]),p.subs=[],p._panelName=p.panelName(),p._selection=p.state.changes("Selected"),p}return r.d(e,t),Object.defineProperty(e,"openForContextAware",{get:function(){return"onlyAll"},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this.subs.push(Object(c.a)(this.renderFeatureChanges(this.textFeaturesBISU,this.textSectionBISU),this.renderFeatureChanges(this.textFeaturesAlign,this.textSectionAlign),this.renderFeatureChanges(this.textFeatureSize,this.textSectionSize),this.renderFeatureChanges(this.textFeatureFont,this.textSectionFont),this.renderFeatureChanges(this.textFeatureColor,this.textSectionColor),this.renderFeatureChanges(this.textFeatureTextPosition,this.textSectionTextPosition)).subscribe((function(){return t.manageSectionVisiblity(t.textSection,[{group:t.textSectionPanelItemBISUAlign,items:[t.textSectionBISU,t.textSectionAlign]},{group:t.textSectionPanelItemFontSize,items:[t.textSectionSize,t.textSectionFont]},{group:t.textSectionPanelItemColor,items:[t.textSectionColor]},{group:t.textSectionPanelTextPosition,items:[t.textSectionTextPosition]}])})),Object(c.a)(this.renderFeatureChanges(this.styleFeatureColor,this.styleSectionColors),this.renderFeatureChanges(this.styleFeatureLineStyle,this.styleSectionLineStyle),this.renderFeatureChanges(this.styleFeatureLineThickness,this.styleSectionLineThickness)).subscribe((function(){return t.manageSectionVisiblity(t.styleSection,[{group:t.styleSectionPanelItemColors,items:[t.styleSectionColors]},{group:t.styleSectionPanelItemStyleThickness,items:[t.styleSectionLineStyle,t.styleSectionLineThickness]}])})),Object(c.a)(this.renderFeatureChanges(this.selectionXFeature,this.selectionX),this.renderFeatureChanges(this.selectionYFeature,this.selectionY),this.renderFeatureChanges(this.selectionWidthFeature,this.selectionWidth),this.renderFeatureChanges(this.selectionHeightFeature,this.selectionHeight),this.renderFeatureChanges(this.selectionAngleFeature,this.selectionAngle),this.renderFeatureChanges(this.connectorStartXFeature,this.connectorStartX),this.renderFeatureChanges(this.connectorStartYFeature,this.connectorStartY),this.renderFeatureChanges(this.connectorEndXFeature,this.connectorEndX),this.renderFeatureChanges(this.connectorEndYFeature,this.connectorEndY)).subscribe((function(){t.manageSectionVisiblity(t.sizeAndPosSection,[{group:t.sizeAndPosPanelItemXY,items:[t.selectionX,t.selectionY]},{group:t.sizeAndPosPanelItemWH,items:[t.selectionWidth,t.selectionHeight]},{group:t.sizeAndPosPanelItemA,items:[t.selectionAngle]},{group:t.sizeAndPosPanelItemConStartXY,items:[t.connectorStartX,t.connectorStartY]},{group:t.sizeAndPosPanelItemConEndXY,items:[t.connectorEndX,t.connectorEndY]}])})),this.features.subscribe((function(e){t.setDiagramFeaturesVisibility(Object(o.isEmpty)(e))})))},e.prototype.panelName=function(){var t=this;return this.ll.forCurrentObserver(!1).pipe(Object(p.a)((function(){return t.state.changes("Selected").pipe(Object(l.a)((function(t){return!Object(o.isEmpty)(t)})),Object(p.a)((function(e){return t.getDocumentChanges(e).pipe(Object(h.a)((function(t){var n,r=[],a=[],i=[],o="";return e.forEach((function(e){var n=t.getShape(e);n.isConnector()?n.isLine()?a.push(n):r.push(n):i.push(n)})),a.length>0&&0===i.length&&0===r.length?n=1===a.length?"Line":a.length+" Lines Selected":r.length>0&&0===i.length&&0===a.length?1===r.length?(n="Connector",o=r[0].name):(n=r.length+" Connectors Selected",o=""):n=i.length>0&&0===r.length&&0===a.length?1===i.length?i[0].name:i.length+" Shapes Selected":r.length+i.length+a.length+" Shapes Selected",{mainText:n,subText:o}})))})))})))},e.prototype.getDocumentChanges=function(t){var e=this.ll.forCurrent(!1);return e.getDiagramOnce().pipe(Object(p.a)((function(n){return 1!==t.length?Object(u.a)(n):Object(c.a)(Object(u.a)(n),e.getDiagramChanges().pipe(Object(h.a)((function(t){return t.model})),Object(l.a)((function(e){var n=e.shapes[t[0]];return n&&n.isConnector()}))))})))},e.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.manageSectionVisiblity=function(t,e){var n=t.nativeElement;n.style.display="none",e.forEach((function(t){var e=t.group.nativeElement;t.items.every((function(t){return 0===t.length}))?e.style.display="none":(e.style.display="",n.style.display="")}))},e.prototype.setDiagramFeaturesVisibility=function(t){var e=this.gridSection.nativeElement,n=this.diagramInfoSection.nativeElement;t?(e.style.display="",n.style.display=""):(e.style.display="none",n.style.display="none")},Object.defineProperty(e.prototype,"id",{get:function(){return"diagraminfo"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return"properties"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltip",{get:function(){return this.translator.instant("TOOLTIPS.DIAGRAM_INFO")},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.diagram||(this.diagram=this.getDiagramObservable())},e.prototype.getDiagramObservable=function(){var t=this;return this.ll.forCurrentObserver(!1).pipe(Object(p.a)((function(t){return t.getDiagramModel()})),Object(p.a)((function(e){var n=t.dataStore.findOne(i.h,{id:e.updatedBy}).pipe(Object(h.a)((function(t){return t&&t.firstName?t:{firstName:"Someone"}})));return Object(d.b)(Object(u.a)(e),n)})),Object(h.a)((function(e){var n=r.h(e,2),a=n[0],i=n[1],o=a.getBounds();return{description:a.description,tagsArray:a.tagsArray,width:Math.round(o.width),height:Math.round(o.height),typeName:a.typeName?a.typeName:"Block Diagram",updatedBy:i.firstName,updatedDate:t.translator.instant("LABELS.UPDATED_THIS")+" "+a.lastUpdatedMoment()}})),Object(f.a)((function(t,e){return Object(o.isEqual)(t,e)})),Object(m.a)())},e.prototype.onActive=function(){this.diagram||(this.diagram=this.getDiagramObservable()),this.diagramSub=this.diagram.connect(),a.hb.track("right.info.panel.click",{value1Type:"status",value1:"open"})},e.prototype.onInactive=function(){a.hb.track("right.info.panel.click",{value1Type:"status",value1:"close"}),this.diagramSub.unsubscribe()},e.prototype.updateDescription=function(t){a.hb.track("right.info.description.change"),this.commandService.dispatch(g.a.updateDiagramInfo,{description:t})},e.prototype.updateTags=function(t){a.hb.track("right.info.tags.update",{value1Type:"tags",value1:t}),this.commandService.dispatch(g.a.updateDiagramInfo,{tags:t})},Object.defineProperty(e.prototype,"uiState",{get:function(){return this.state.changes("InterfaceControlState")},enumerable:!0,configurable:!0}),e.prototype.showGrid=function(t){var e=t?"true":"false";a.hb.track("right.info.grid."+e),this.gridService.showGrid.value!==t&&this.gridService.showGrid.next(t)},e.prototype.snapToGrid=function(t){var e=t?"true":"false";a.hb.track("right.info.snap."+e),this.gridService.enableSnapToGrid.value!==t&&this.gridService.enableSnapToGrid.next(t)},e}(A)},"2m+3":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("D57K"),a=n("LiEJ"),i=n("ADlH"),o=function(){function t(){this.enableSnapToGrid=new a.a(!0),this.showGrid=new a.a(!0),this.gridSizeMajor=5*t.gridSize}return t.prototype.isOnGrid=function(e){return e%t.gridSize==0},t.prototype.isOnGridMajor=function(t){return t%this.gridSizeMajor==0},t.prototype.snapToGrid=function(e){return Object(i.roundN)(e,t.gridSize)},t.prototype.snapToGridNext=function(e){return Object(i.ceilN)(e,t.gridSize)},t.prototype.snapToGridPrevious=function(e){return Object(i.floorN)(e,t.gridSize)},t.prototype.getGridLines=function(e,n){var a,i;return r.e(this,(function(r){switch(r.label){case 0:if(e===n)throw Error("Start and end of the grid line location cant be same");a=e<n?t.gridSize:-t.gridSize,i=e,this.isOnGrid(e)||(i=a>0?this.snapToGridNext(e):this.snapToGridPrevious(e)),r.label=1;case 1:return a>0&&i<n||a<0&&i>n?[4,i]:[3,3];case 2:return r.sent(),i+=a,[3,1];case 3:return[2]}}))},t.prototype.point=function(t){return this.enableSnapToGrid.value&&(t.x=this.adjustToGrid(t.x),t.y=this.adjustToGrid(t.y)),t},t.prototype.shapeTransform=function(t,e){return e},t.prototype.connectorPoints=function(t,e){return e},t.prototype.adjustToGrid=function(e){return e.value=Math.round(e.value),this.isOnGrid(e.value)?(this.adjustToGridProperty("low",e),this.adjustToGridProperty("high",e),e):0===e.low?(e.value=this.snapToGridNext(e.value),this.adjustToGridProperty("high",e)):0===e.high?(e.value=this.snapToGridPrevious(e.value),this.adjustToGridProperty("low",e)):(e.low<=t.gridSize&&e.high<=t.gridSize?e.value=this.snapToGrid(e.value):e.low>t.gridSize&&e.high>t.gridSize?e.low<e.high?e.value=this.snapToGridPrevious(e.value-e.low):e.value=this.snapToGridNext(e.value+e.high):e.low>t.gridSize?e.value=this.snapToGridNext(e.value):e.high>t.gridSize&&(e.value=this.snapToGridPrevious(e.value)),this.adjustToGridProperty("low",e),this.adjustToGridProperty("high",e),e)},t.prototype.adjustToGridProperty=function(e,n){return 0===n[e]?n:(n[e]<=t.gridSize?n[e]=t.gridSize:n[e]=this.snapToGridNext(n[e]),n)},t.gridSize=10,t}()},"3+4Q":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("D57K"),a=n("5xGT"),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.isResolved=function(){return!!this.resolved},e.prototype.isDeleted=function(){return!!this.deleted},e.prototype.isEdited=function(){return!!this.edited},e.prototype.isNew=function(t){return!(this.isResolved()||this.userId===t||this.seenBy&&this.seenBy.includes(t))},e.prototype.getTime=function(){return""+a.w.formatDistance(this.added,(new Date).getTime())},e}(a.f)},"4e1j":function(t,e,n){"use strict";var r=n("0N1A"),a=n("4kdB"),i=10,o=40,s=800;function c(t){var e=0,n=0,r=0,a=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=e*i,a=n*i,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||a)&&t.deltaMode&&(1==t.deltaMode?(r*=o,a*=o):(r*=s,a*=s)),r&&!e&&(e=r<1?-1:1),a&&!n&&(n=a<1?-1:1),{spinX:e,spinY:n,pixelX:r,pixelY:a}}c.getEventType=function(){return r.firefox()?"DOMMouseScroll":a("wheel")?"wheel":"mousewheel"},t.exports=c},"4kdB":function(t,e,n){"use strict";var r,a=n("c3EF");a.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),t.exports=function(t,e){if(!a.canUseDOM||e&&!("addEventListener"in document))return!1;var n="on"+t,i=n in document;if(!i){var o=document.createElement("div");o.setAttribute(n,"return;"),i="function"==typeof o[n]}return!i&&r&&"wheel"===t&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}},AaYA:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("19Zn"),a=n("fQLH"),i=n("LiEJ"),o=n("d9YI"),s=function(){function t(){this._change=new a.a,this.selectedElement=new i.a("none")}return Object.defineProperty(t.prototype,"containerElement",{get:function(){return this.container?this.container.nativeElement:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"change",{get:function(){return this._change},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){this.selectedElement.next(r.B.getTextPositionString(t)),this._data=t,t.transform&&this.setRotation(t.transform)},t.prototype.setRotation=function(t){var e=t.angle;this.containerElement&&(t.scaleX>0&&t.scaleY<0&&0===e&&(e=180),e>=0&&e<45?this.containerElement.style.transform="rotate(0)":e>=45&&e<90?this.containerElement.style.transform="rotate(90deg)":e>=90&&e<135?this.containerElement.style.transform="rotate(90deg)":e>=135&&e<=180?this.containerElement.style.transform="rotate(180deg)":e<=0&&e>-45?this.containerElement.style.transform="rotate(0)":e<=-45&&e>-90?this.containerElement.style.transform="rotate(-90deg)":e<=-90&&e>-135?this.containerElement.style.transform="rotate(-90deg)":e<=-135&&e>=-180&&(this.containerElement.style.transform="rotate(-180deg)"))},t.prototype.setProperties=function(t){},t.prototype.apply=function(){},t.prototype.applyAnimated=function(){return Object(o.b)()},t.prototype.handleClick=function(t){this._change.next(this.getDataPositionData(t))},t.prototype.getDataPositionData=function(t){return"ex-top-left"===t?{xType:"fixed-start",x:0,yType:"fixed-start",y:-1,alignX:-1,alignY:1,wordWrap:!1}:"ex-top-center"===t?{xType:"relative",x:.5,yType:"fixed-start",y:-1,alignX:0,alignY:1,wordWrap:!1}:"ex-top-right"===t?{xType:"fixed-end",x:0,yType:"fixed-start",y:-1,alignX:1,alignY:1,wordWrap:!1}:"in-top-left"===t?{xType:"fixed-start",x:1,yType:"fixed-start",y:1,alignX:-1,alignY:-1,wordWrap:!0}:"in-top-center"===t?{xType:"relative",x:.5,yType:"fixed-start",y:1,alignX:0,alignY:-1,wordWrap:!0}:"in-top-right"===t?{xType:"fixed-end",x:1,yType:"fixed-start",y:1,alignX:1,alignY:-1,wordWrap:!0}:"in-center-left"===t?{xType:"fixed-start",x:1,yType:"relative",y:.5,alignX:-1,alignY:0,wordWrap:!0}:"in-center-center"===t?{xType:"relative",x:.5,yType:"relative",y:.5,alignX:0,alignY:0,wordWrap:!0}:"in-center-right"===t?{xType:"fixed-end",x:1,yType:"relative",y:.5,alignX:1,alignY:0,wordWrap:!0}:"in-bottom-left"===t?{xType:"fixed-start",x:1,yType:"fixed-end",y:1,alignX:-1,alignY:1,wordWrap:!0}:"in-bottom-center"===t?{xType:"relative",x:.5,yType:"fixed-end",y:1,alignX:0,alignY:1,wordWrap:!0}:"in-bottom-right"===t?{xType:"fixed-end",x:1,yType:"fixed-end",y:1,alignX:1,alignY:1,wordWrap:!0}:"ex-bottom-left"===t?{xType:"fixed-start",x:0,yType:"fixed-end",y:-1,alignX:-1,alignY:-1,wordWrap:!1}:"ex-bottom-center"===t?{xType:"relative",x:.5,yType:"fixed-end",y:-1,alignX:0,alignY:-1,wordWrap:!1}:"ex-bottom-right"===t?{xType:"fixed-end",x:0,yType:"fixed-end",y:-1,alignX:1,alignY:-1,wordWrap:!1}:"ex-left-top"===t?{xType:"fixed-start",x:-1,yType:"fixed-start",y:0,alignX:1,alignY:-1,wordWrap:!1}:"ex-right-top"===t?{xType:"fixed-end",x:-1,yType:"fixed-start",y:0,alignX:-1,alignY:-1,wordWrap:!1}:"ex-left-center"===t?{xType:"fixed-start",x:-1,yType:"relative",y:.5,alignX:1,alignY:0,wordWrap:!1}:"ex-right-center"===t?{xType:"fixed-end",x:-1,yType:"relative",y:.5,alignX:-1,alignY:0,wordWrap:!1}:"ex-left-bottom"===t?{xType:"fixed-start",x:-1,yType:"fixed-end",y:0,alignX:1,alignY:1,wordWrap:!1}:"ex-right-bottom"===t?{xType:"fixed-end",x:-1,yType:"fixed-end",y:0,alignX:-1,alignY:1,wordWrap:!1}:void 0},t}()},IGWl:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("fQLH"),a=n("LiEJ"),i=n("d9YI"),o=function(){function t(){this._change=new r.a,this.iconSource=new a.a("")}return Object.defineProperty(t.prototype,"tooltipValue",{get:function(){return this._props?this._props.tooltip:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"change",{get:function(){return this._change.asObservable()},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){this._data=t},t.prototype.setProperties=function(t){this._props=t},t.prototype.apply=function(){this._props.icon&&this.iconSource.next("./assets/icons/symbol-defs.svg#"+this._props.icon),this._data&&this.button&&(this._data.value?this.button.nativeElement.classList.add("active"):this.button.nativeElement.classList.remove("active"))},t.prototype.applyAnimated=function(){return this.apply(),Object(i.b)()},t}()},LC7v:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("D57K"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(n("hSRu").a)},LLEj:function(t,e,n){"use strict";var r=n("D57K"),a=(n("Wpmq"),n("U3QC")),i=n("4HYP"),o=n("mhnT"),s=n("z5yO"),c=n("Jg5f"),u=n("AouM"),d=function(t){function e(e,n,r,a){void 0===r&&(r=!0),void 0===a&&(a=!0);var i=t.call(this,e,n,r,a)||this;return i.offsetX=n.nativeEvent.offsetX,i.offsetY=n.nativeEvent.offsetY,i.clientX=n.nativeEvent.clientX,i.clientY=n.nativeEvent.clientY,i}return r.d(e,t),e}(n("MvFr").a),p=function(t){function e(e,n,r,a){void 0===r&&(r=!0),void 0===a&&(a=!0);var i=t.call(this,e,n,r,a)||this;return i.setRelatedShape(n),i}return r.d(e,t),e}(d),l=n("ljsB"),h=n("5xGT"),f=n("gQst"),m=n("iUUs"),g=n("d62g"),b=n("5p5l"),y=n("pN2L"),v=n("/xGf");n.d(e,"a",(function(){return O}));var O=function(){function t(t,e){this.commandService=t,this.vToDcoordinate=e,this.zoomSensitivity=1/800,this.panSensitivity=.25,this.subs=[]}return t.prototype.initialize=function(t,e,n){var r=this;this.diagramCanvas=t,this.interactionCanvas=e,this.gridCanvas=n;var i=this.getStageWheelOnNoKeysDown().pipe(Object(a.a)((function(t){r.updatePan(-t.pixelX*r.panSensitivity,-t.pixelY*r.panSensitivity)}))),o=this.getStageWheelOnCtrlKeyDown().pipe(Object(a.a)((function(t){return r.updateZoom(1-t.pixelY*r.zoomSensitivity,t.offsetX,t.offsetY)}))),s=this.getAllCanvasMouseCapture().pipe(Object(a.a)((function(){return r.interactionCanvas.canvas.focus()})));return Object(f.a)(i,o,s)},t.prototype.destroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe();this.diagramCanvas=void 0,this.interactionCanvas=void 0,this.gridCanvas=void 0},t.prototype.getShapeTouch=function(){var t=this;return this.getShapes().pipe(Object(i.a)((function(e){return Object(m.a)(e,"mousedown").pipe(Object(o.a)(Object(m.a)(t.diagramCanvas,"childRemoved").pipe(Object(s.a)((function(t){return t.child===e})))))})),Object(c.a)((function(t){return t})))},t.prototype.getShapes=function(){var t=this;return Object(g.a)(Object(b.a)(0,this.diagramCanvas.numChildren).pipe(Object(c.a)((function(e){return t.diagramCanvas.getChildAt(e)}))),Object(m.a)(this.diagramCanvas,"childAdded").pipe(Object(c.a)((function(t){return t.child}))))},t.prototype.getShapeRightClick=function(){return this.getShapeTouch().pipe(Object(s.a)((function(t){return 2===t.nativeEvent.button})),Object(c.a)((function(t){return new p("shapeRightClick",t)})))},t.prototype.getAllCanvas=function(){return Object(y.a)(this.diagramCanvas,this.interactionCanvas,this.gridCanvas)},t.prototype.getAllCanvasMouseCapture=function(){return this.getAllCanvas().pipe(Object(i.a)((function(t){return Object(f.a)(Object(m.a)(t,"mousedown",{capture:!0}),Object(m.a)(t,"pressmove",{capture:!0}),Object(m.a)(t,"pressup",{capture:!0}))})),Object(c.a)((function(t){return t})))},t.prototype.getStageDrag=function(t){return Object(m.a)(t,"stagemousedown").pipe(Object(u.a)((function(){return Object(m.a)(t,"stagemousemove").pipe(Object(o.a)(Object(m.a)(t,"stagemouseup")))})),Object(c.a)((function(t){return t})))},t.prototype.getStageMouseDown=function(t){return Object(m.a)(t,"mousedown").pipe(Object(c.a)((function(t){return t})))},t.prototype.getStagePressUp=function(t){return Object(m.a)(t,"pressup").pipe(Object(c.a)((function(t){return t})))},t.prototype.getStageWheel=function(){return Object(f.a)(Object(m.a)(this.interactionCanvas.canvas,"gesturestart"),Object(m.a)(this.interactionCanvas.canvas,"gesturechange"),Object(m.a)(this.interactionCanvas.canvas,"gestureend"),Object(m.a)(this.interactionCanvas.canvas,"wheel")).pipe(Object(c.a)((function(t){if("gesturestart"===t.type||"gesturechange"===t.type||"gestureend"===t.type){var e=t.scale>1?-1*t.scale:t.scale+1.5;t.pixelY=e,t.offsetX=t.clientX,t.offsetY=t.clientY,t.gesture=!0}else{var n=v(t);t.pixelX=n.pixelX,t.pixelY=n.pixelY,t.gesture=!1}return t})),Object(a.a)((function(t){return t.preventDefault()})))},t.prototype.getStageWheelOnCtrlKeyDown=function(){return this.getStageWheel().pipe(Object(s.a)((function(t){return t.ctrlKey||t.metaKey||t.gesture})),Object(c.a)((function(t){return t})))},t.prototype.getStageWheelOnNoKeysDown=function(){return this.getStageWheel().pipe(Object(s.a)((function(t){return!t.metaKey&&!t.ctrlKey&&!t.gesture})),Object(c.a)((function(t){return t})))},t.prototype.getStageRightClick=function(t){return this.getStageMouseDown(t).pipe(Object(s.a)((function(t){return 2===t.nativeEvent.button})),Object(c.a)((function(t){return new d("canvasRightClick",t)})))},t.prototype.updatePan=function(t,e){this.commandService.dispatch(l.a.panDiagram,{dx:t,dy:e,animate:!1})},t.prototype.updateZoom=function(t,e,n){this.commandService.dispatch(l.a.zoomDiagram,{delta:t,toX:e,toY:n,animate:!1})},t.prototype.getCursor=function(){return Object(y.a)(this.defaultCursor)},t.prototype.getObjectsUnderPoint=function(t){return r.j(this.interactionCanvas.getObjectsUnderPoint(t.x,t.y,0),this.diagramCanvas.getObjectsUnderPoint(this.vToDcoordinate.x(t.x),this.vToDcoordinate.y(t.y),0)).filter((function(t){return!!t.getCursor}))},t.prototype.getCursorByContext=function(t,e){var n=t.find((function(t){var n=t.getCursor(e);return n&&(!!n.cursor||!!n.tail)}));return n?n.getCursor(e):this.defaultCursor},t.prototype.pointerMove=function(){return Object(m.a)(this.interactionCanvas,"stagemousemove").pipe(Object(c.a)((function(t){return{x:t.stageX,y:t.stageY}})))},t}();!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t)}(h.fb)},MvFr:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("D57K"),a=n("deqJ"),i=n("h1tj"),o=function(t){function e(e,n,r,a){void 0===r&&(r=!0),void 0===a&&(a=!0);var i=t.call(this,e,r,a)||this;return i.relatedMouseEvent=n,i.relatedShape=n.target,i}return r.d(e,t),e.prototype.setRelatedShape=function(t){if(t.target instanceof a.a)this.relatedShape=t.target;else if(t.currentTarget instanceof a.a)this.relatedShape=t.currentTarget;else for(var e=t.target;e&&e.parent;){if(e.parent instanceof a.a){this.relatedShape=e.parent;break}e=e.parent}},e}(i.Event)},O6K7:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var r,a=n("D57K"),i=n("MvFr");!function(t){t.CreateComment="create-comment"}(r||(r={}));var o=function(t){function e(e,n){var r=t.call(this,e,n,!0,!0)||this;return r.relatedShape=null,r.setRelatedShape(n),r}return a.d(e,t),e.prototype.getShapeId=function(){return this.relatedShape?this.relatedShape.name:null},e.prototype.getPosition=function(){return{x:this.relatedMouseEvent.stageX,y:this.relatedMouseEvent.stageY}},e}(i.a)},P1E4:function(t,e,n){"use strict";var r=n("D57K"),a=n("5xGT"),i=n("fqe/"),o=n("nsO7"),s=n("d9YI"),c=function(t){function e(e,n,r){var a=t.call(this)||this;return a.auth=e,a.random=n,a.state=r,a}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["IProjectCommand","INeutrinoRestCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataDefinition",{get:function(){return{id:!1,createdTime:!1,name:!1,type:!1}},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){this.data||(this.data={}),this.data.id||(this.data.id=this.random.diagramId()),this.data.createdTime||(this.data.createdTime=Date.now()),this.data.name||(this.data.name="Untitled Document"),this.data.type||(this.data.type="diagram/def/block.js#Block"),this.data.auth=this.auth.token,this.data.rid=this.resourceId},e.prototype.executeResult=function(t){var e=Object(o.merge)(t.result.model,t.result.modelStatic),n=this.state.get("RecentDiagrams");n&&(n.find((function(e){return e.id===t.result.model.id}))||(n.unshift(e),this.state.set("RecentDiagrams",n)));var r=this.state.get("ProjectDiagrams");if(r&&Object.keys(r).length>0){var a="string"==typeof e.project?e.project:e.project.id;r[a]&&(r[a].push(e),this.state.set("ProjectDiagrams",r))}return!0},e.prototype.execute=function(){return Object(s.b)()},Object.defineProperty(e,"resultType",{get:function(){return{result:Object}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"httpUrl",{get:function(){throw new Error("Must be implemented in concrete create diagram command")},enumerable:!0,configurable:!0}),e}(a.d),u=function(t){function e(e,n,r){var a=t.call(this,e,n,r)||this;return a.auth=e,a.random=n,a.state=r,a}return r.d(e,t),e.prototype.executeResult=function(e){return t.prototype.executeResult.call(this,e)},Object.defineProperty(e.prototype,"httpUrl",{get:function(){return a.h.get("REST_API_BASE_URL")+"/"+a.h.get("MESSAGE_PROTOCOL_VERSION")+"/1/project/create-diagram-private"},enumerable:!0,configurable:!0}),e=r.c([Object(a.l)(),r.f("design:paramtypes",[i.a,a.T,a.fb])],e)}(c);Object.defineProperty(u,"name",{value:"CreateDiagramPrivate"});var d=function(t){function e(e,n,r){var a=t.call(this,e,n,r)||this;return a.auth=e,a.random=n,a.state=r,a}return r.d(e,t),e.prototype.executeResult=function(e){return t.prototype.executeResult.call(this,e)},Object.defineProperty(e.prototype,"httpUrl",{get:function(){return a.h.get("REST_API_BASE_URL")+"/"+a.h.get("MESSAGE_PROTOCOL_VERSION")+"/1/project/create-diagram-public"},enumerable:!0,configurable:!0}),e=r.c([Object(a.l)(),r.f("design:paramtypes",[i.a,a.T,a.fb])],e)}(c);Object.defineProperty(d,"name",{value:"CreateDiagramPublic"});var p=n("LLJp"),l=n("hX56"),h=n("3riI"),f=n("oyCe"),m=n("Dze+"),g=function(t){function e(e){var n=t.call(this)||this;return n.store=e,n}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return r.j(m.a.implements,["IDiagramCommand"])},enumerable:!0,configurable:!0}),e.prototype.executeResult=function(){var t=this.store.getModelStore(f.a);return Object(h.b)(t.removeChanges({modelId:this.resourceId}),t.insert(this.resultData.model),t.insertStatic(this.resultData.modelStatic))},e=r.c([Object(a.l)(),r.f("design:paramtypes",[l.b])],e)}(m.a);Object.defineProperty(g,"name",{writable:!0,value:"LoadDocument"});var b=n("19Zn"),y=n("iJR/"),v=n("pN2L"),O=n("d62g"),j=n("8Fqk"),S=n("G2Mx"),C=n("U3QC"),I=n("icD7"),D=n("QoSw"),x=function(t){function e(e,n,r){var a=t.call(this)||this;return a.ll=e,a.resources=n,a.store=r,a}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return r.j(m.a.implements,["IDiagramCommand"])},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this,e=this.store.getModelStore(f.a),n={id:this.resourceId};return Object(h.b)(e.findOneRawModel(n),e.findOneStatic(n),this.createDocumentSvg(this.resourceId)).pipe(Object(S.a)(1),Object(C.a)((function(e){var n=r.h(e,3),a=n[0],i=n[1],o=n[2];t.data={model:a,modelStatic:i,svg:o}})))},e.prototype.execute=function(){var t=this.store.getModelStore(f.a);return Object(y.a)(t.insert(this.data.model))},e.prototype.executeResult=function(){var t=this.store.getModelStore(f.a);return Object(y.a)(t.removeChanges({modelId:this.resourceId}))},e.prototype.createDocumentSvg=function(t){var e=this.ll.forDiagram(t,!0),n=new b.l(Object(v.a)(e),this.resources);return Object(O.a)(Object(j.a)((function(){return n.populateDiagram().pipe(Object(I.a)())})),Object(j.a)((function(){return n.toSvg()})))},e=r.c([Object(a.l)(),r.f("design:paramtypes",[D.a,a.F,l.b])],e)}(m.a);Object.defineProperty(x,"name",{writable:!0,value:"SaveDocument"}),n.d(e,"a",(function(){return P}));var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.registerCreateDiagramPrivate=function(t){var e=this;t.mapSequence(this.createDiagramPrivate).add(p.a).add(u,{transform:function(t){return e.transformDataForCreate(t)}})},e.registerCreateDiagramPublic=function(t){var e=this;t.mapSequence(this.createDiagramPublic).add(p.a).add(d,{transform:function(t){return e.transformDataForCreate(t)}})},e.registerLoadDocument=function(t){t.mapSequence(this.loadDocument).add(g)},e.registerSaveDocument=function(t){t.mapSequence(this.saveDocument).add(x)},e.transformDataForCreate=function(t){var e=t.data[0];if(t.resultData&&t.resultData[0]){var n=t.resultData[0].templateData;n&&(e.shapes=n.shapes,e.type=n.type,n.hasOwnProperty("connections")&&(e.connections=n.connections),n.hasOwnProperty("groups")&&(e.groups=n.groups),n.hasOwnProperty("description")&&(e.description=n.description),n.hasOwnProperty("tags")&&(e.tags=n.tags),t.eventData&&t.eventData.hasOwnProperty("type")&&"duplicate"===t.eventData.type&&(e.name=n.name+" - Copy"))}return delete e.templateId,e},e.createDiagramPrivate=new e("CreateDiagramPrivate"),e.createDiagramPublic=new e("CreateDiagramPublic"),e.loadDocument=new e("LoadDocument"),e.saveDocument=new e("SaveDocument"),e}(a.g)},QCJn:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("D57K"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(n("hSRu").a)},"S83/":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("D57K"),a=n("h1tj"),i=n("d9YI"),o=n("nsO7"),s=n("fQLH"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.get=function(t,n,r,i){return i&&a.Tween.removeTweens(t),new e(t,n,r)},e.simulate=function(t){return this.get(t)},e.prototype.to=function(e,n,r){return t.prototype.to.call(this,e,n,r),this.propNames=Object.keys(e),this},e.prototype.cancel=function(){this.completed||(this.removeFromTweens(),this.clear())},Object.defineProperty(e.prototype,"completed",{get:function(){return this.position>=this.duration},enumerable:!0,configurable:!0}),e.prototype.changes=function(){var t=this;return this._progress?this._progress:this.completed?Object(i.b)():(this._progress=new s.a,this.addEventListener("change",(function(){t._progress.next(Object(o.pick)(t.target,t.propNames))})),this.call((function(){t._progress.next(Object(o.pick)(t.target,t.propNames)),t.clear()})),this._progress)},e.prototype.removeFromTweens=function(){var t=a.Tween._tweens,e=t.indexOf(this);e>-1&&t.splice(e,1),this._paused=!0},e.prototype.clear=function(){this._progress&&(this._progress.complete(),this.removeAllEventListeners("change"),this._progress=void 0)},e}(a.Tween)},SKSx:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r=n("D57K"),a=n("h1tj"),i=n("g3Dv"),o=n("C0rp"),s=function(t){function e(e,n,r,a,i,o){var s=t.call(this)||this;return s.value=e,s.text=n,s.width=i,s.height=o,s.graphics.clear(),s.graphics.beginFill("rgba(0,0,0,0.01)"),s.graphics.drawRect(0,0,s.width,s.height),s.graphics.endFill(),s.x=r,s.y=a,s}return r.d(e,t),e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e}(a.Shape),c=function(t){function e(e,n){var r=t.call(this)||this;r.text=e,r.origin=n;var a=o.document(i.c);return a.load(e.content),a.width(e.width),a.getLinksData().forEach((function(t){var e=new s(t.value,t.text,t.x,t.y,t.width,t.height);r.addChild(e)})),r}return r.d(e,t),e.prototype.destroy=function(){},e}(a.Container)},T4Sa:function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var r=n("D57K"),a=n("3+4Q"),i=n("5xGT"),o=n("qMyy"),s=n("yn08"),c=n("LiEJ"),u=n("fQLH"),d=n("3riI"),p=n("pN2L"),l=n("iUUs"),h=n("U3QC"),f=n("lqvn"),m=n("R+ki"),g=n("Jg5f"),b=n("G2Mx"),y=n("AouM"),v=n("z5yO"),O=n("g3Dv"),j=(n("hX56"),n("4y1S")),S=n("nsO7"),C=n("ljsB"),I=(n("QoSw"),n("lu3Q"),n("sXdR")),D=function(){function t(t,e,n,r,a,i,o){var s=this;this.commands=t,this.state=e,this.datastore=n,this.userLocator=r,this.translateService=a,this.ll=i,this.cursorGen=o,this.toggleEnabled=new c.a(!1),this.toggleCommandHandler=new u.a,this.intervalDuration=3e3,this.toggleThrottle=400,this.isCommentMode=new c.a(!1),this.buttonCursor=new u.a,this.subs=[],this.subs.push(this.getHideHelpMessageInteraction().subscribe((function(){return s.isCommentMode.next(!1)})),this.state.changes("CurrentDiagram").pipe(Object(h.a)((function(t){s.diagramId=t,s.unresolvedComments=s.getUnresolvedComments(),s.resolvedComments=s.getResolvedComments(),s.showDefaultMessage=s.shouldShowDefaultMessage(),s.resolvedLabel=s.getResolvedLabel()}))).subscribe(),this.checkForNewComments().subscribe(),this.getCommentToggleState().subscribe(),this.handleToggleChange().subscribe(),this.handleCancelKeyboardEvent().subscribe(),this.state.changes("CurrentInteractionHandler").pipe(Object(f.a)((function(t,e){return t.type===e.type})),Object(h.a)((function(t){var e=t.injector.get(t.type).defaultCursor;s.buttonCursor.next(s.getButtonCursor(e))}))).subscribe())}return t.prototype.handleCommentToggle=function(t){this.toggleCommandHandler.next(t)},t.prototype.handleToggleChange=function(){var t=this;return this.toggleCommandHandler.pipe(Object(m.a)(this.toggleThrottle),Object(I.lodashThrottle)(this.toggleThrottle,{leading:!1,trailing:!0}),Object(h.a)((function(e){t.commands.dispatch(j.g.updateUserPreference,{preferenceName:"show_comment_indicator",value:e})})))},t.prototype.getButtonCursor=function(t){return"cur"===t.type&&"comment"===t.cursor?this.cursorGen.getCursorIcon(t):"pointer"},t.prototype.handleCommentItemClick=function(t){var e=this;i.hb.track("right.comment.show",{value1Type:"trigger",value1:"panel"}),this.ll.forCurrent(!1).getDiagramOnce().pipe(Object(h.a)((function(n){n.shapes&&n.shapes[t.shapeId]?e.commands.dispatch(C.a.focusToPoint,{shapeIds:[t.shapeId],coordinates:t.locOnDiagram}):e.commands.dispatch(C.a.focusToPoint,{shapeIds:null,coordinates:t.locOnDiagram})}))).subscribe();var n={visible:!0,threadId:t.id,comments:[t]};this.state.set("CommentThreadData",n)},t.prototype.updateSelectedProperty=function(t){var e=this;return this.state.changes("CommentThreadData").pipe(Object(g.a)((function(n){return n.visible?t.map((function(t){return t.parentComment.id===n.threadId?(t.selected=!0,e.startMarkSeenByTimer(t.parentComment)):t.selected=!1,t})):t.map((function(t){return t.selected=!1,t}))})))},t.prototype.startMarkSeenByTimer=function(t){var e=this;setTimeout((function(){return r.b(e,void 0,void 0,(function(){return r.e(this,(function(e){return this.markSeenBy(t),[2]}))}))}),this.intervalDuration)},t.prototype.markSeenBy=function(t){var e=this;this.datastore.find(a.a,{diagramId:this.diagramId,parentId:t.id}).pipe(Object(b.a)(1),Object(h.a)((function(n){var r=[];e.shouldAddSeenBy(t)&&r.push(t.id),n.forEach((function(t){e.shouldAddSeenBy(t)&&r.push(t.id)})),r.length>0&&e.commands.dispatch(o.a.markCommentSeen,{commentIds:r,userId:e.state.get("CurrentUser")})}))).subscribe()},t.prototype.shouldAddSeenBy=function(t){var e=this.state.get("CurrentUser");return t.userId!==e&&!t.seenBy.includes(e)},t.prototype.getCommentToggleState=function(){var t=this;return this.userLocator.getCommentToggleState().pipe(Object(f.a)(),Object(g.a)((function(e){t.toggleEnabled.next(e)})))},t.prototype.checkForNewComments=function(){var t=this;return this.datastore.find(a.a,{diagramId:this.diagramId,$or:[{resolved:null},{resolved:!1}]}).pipe(Object(h.a)((function(e){for(var n=!1,r=0;r<e.length;r++)if(e[r].isNew(t.state.get("CurrentUser"))){n=!0;break}t.state.set("ShowSideBarButtonIndicator",{id:t.id,show:n})})))},t.prototype.shouldShowDefaultMessage=function(){return Object(d.b)(this.unresolvedComments,this.resolvedComments).pipe(Object(g.a)((function(t){var e=r.h(t,2),n=e[0],a=e[1];return 0===n.length&&0===a.length})))},t.prototype.getResolvedComments=function(){var t=this;return this.datastore.find(a.a,{diagramId:this.diagramId,parentId:null,resolved:{$exists:!0}}).pipe(Object(y.a)((function(e){return t.getCommentList(e)})),Object(y.a)((function(e){return e.length>0?t.updateCommentWithResolvedUser(e):Object(p.a)([])})))},t.prototype.updateCommentWithResolvedUser=function(t){var e=this;return d.b.apply(void 0,r.j(t.map((function(t){return e.userLocator.getUserInfo(t.parentComment.resolvedBy).pipe(Object(v.a)((function(t){return!!t})),Object(b.a)(1),Object(g.a)((function(e){return t.resolvedCommentor=e,t})))}))))},t.prototype.getUnresolvedComments=function(){var t=this;return this.datastore.find(a.a,{diagramId:this.diagramId,parentId:null,$and:[{$or:[{resolved:null},{resolved:!1}]}]}).pipe(Object(y.a)((function(e){return t.getCommentList(e)})),Object(y.a)((function(e){return t.updateSelectedProperty(e)})))},t.prototype.getCommentList=function(t){var e=this;return t&&t.length>0?d.b.apply(void 0,r.j(t.map((function(t){return e.getCommentItem(t)})))).pipe(Object(g.a)((function(t){return t=t.filter((function(t){return!t.latestComment.deleted})),Object(S.orderBy)(t,["lastUpdatedTime"],["desc"])}))):Object(p.a)([])},t.prototype.getCommentItem=function(t){var e=this;return this.datastore.find(a.a,{diagramId:this.diagramId,$or:[{deleted:null},{deleted:!1}],parentId:t.id},{sort:{lastUpdated:1}}).pipe(Object(y.a)((function(n){n.unshift(t);var a=e.getCommenterIds(n,2);return d.b.apply(void 0,r.j(a.map((function(t){return e.userLocator.getUserInfo(t).pipe(Object(v.a)((function(t){return!!t})),Object(b.a)(1))})))).pipe(Object(g.a)((function(r){return e.buildCommentItem(r[r.length-1],r[r.length-2],n.length,t,n[n.length-1],n[n.length-1].lastUpdated)})))})))},t.prototype.buildCommentItem=function(t,e,n,r,a,i){var o={threadCommenter:t,commentCount:n,latestComment:a,parentComment:r,lastUpdatedTime:i,selected:!1};return a.parentId||(a.parentId=null),e&&(o.previousThreadCommenter=e),o},t.prototype.getCommenterIds=function(t,e){var n,a,i=[];try{for(var o=r.k(t),s=o.next();!s.done;s=o.next()){var c=s.value;if(i.includes(c.userId)||i.push(c.userId),i.length>=e)break}}catch(u){n={error:u}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return i},t.prototype.onActive=function(){i.hb.track("right.styles.panel.click",{value1Type:"status",value1:"open"})},t.prototype.onInactive=function(){i.hb.track("right.styles.panel.click",{value1Type:"status",value1:"close"}),this.toggleAddCommentMode(!1)},Object.defineProperty(t,"openForContextAware",{get:function(){return"onlyAll"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return"diagramcomments"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"icon",{get:function(){return"comment"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this.translateService.instant("TOOLTIPS.DIAGRAM_COMMENTS")},enumerable:!0,configurable:!0}),t.prototype.handleCancelButtonClick=function(){i.hb.track("right.comment.cancel",{value1Type:"trigger",value1:"button-click"}),this.toggleAddCommentMode(!1)},t.prototype.toggleAddCommentMode=function(t){var e;t?(i.hb.track("right.comment.add.click",{value1Type:"trigger",value1:"button-click"}),e={state:s.b.Comment}):e={state:s.b.Normal},this.isCommentMode.next(t),this.commands.dispatch(o.a.changeMouseControlState,null,e)},t.prototype.handleCancelKeyboardEvent=function(){var t=this;return Object(l.a)(window,"keydown").pipe(Object(v.a)((function(t){return t.keyCode===O.f.Escape})),Object(h.a)((function(){i.hb.track("right.comment.cancel",{value1Type:"trigger",value1:"esc"}),t.toggleAddCommentMode(!1)})))},t.prototype.getHideHelpMessageInteraction=function(){return this.state.changes("MouseControlState").pipe(Object(v.a)((function(t){return t!==s.b.Comment})))},t.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},t.prototype.getResolvedLabel=function(){var t=this;return this.resolvedComments.pipe(Object(y.a)((function(e){return t.translate("COMMENTS.LABELS.RESOLVED",{noOfThreads:e.length})})))},t.prototype.translate=function(t,e){return this.translateService.get(t,e).pipe(Object(b.a)(1))},t}()},TQyE:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("R+ki"),a=n("fQLH"),i=n("LiEJ"),o=n("d9YI"),s=n("nsO7"),c=function(){function t(){this._change=new a.a,this._isDiffColor=new i.a(!1),this._label=new i.a("")}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"change",{get:function(){return this._change.pipe(Object(r.a)(100))},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){this._data=Object(s.clone)(t),void 0!==this._data.params&&(this._data.params.isDiffColor?(this._data.value="#FFFFFF",this._isDiffColor.next(!0)):this._isDiffColor.next(!1))},t.prototype.setProperties=function(t){this._props=t},t.prototype.apply=function(){this.colorpicker.nativeElement.style.backgroundColor=this._data.value,this._label.next(this._props.label)},t.prototype.applyAnimated=function(){return this.apply(),Object(o.b)()},t}()},c3EF:function(t,e,n){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),a={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};t.exports=a},deqJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("D57K"),a=n("h1tj"),i=function(t){function e(e,n){var r=t.call(this)||this;return r._type=n,r.name=e,r}return r.d(e,t),e.prototype.getCursor=function(t){return null},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),e.prototype.convertToCursorDrawable=function(t){var e=this;t.getCursor=function(t){return e.getCursor(t)}},e}(a.Container)},elRR:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("D57K"),a=n("SKSx"),i=(n("Wpmq"),n("U3QC")),o=n("IMYO"),s=n("hOK2"),c=n("W/Ou"),u=n("Jg5f"),d=n("lqvn"),p=n("iUUs"),l=n("d9YI"),h=n("gQst"),f=(n("5xGT"),n("LLEj")),m=(n("6GT9"),n("sXdR")),g=(n("7zx0"),function(t){function e(e,n,r,a,i){var o=t.call(this,e,n)||this;return o.commandService=e,o.vToDcoordinate=n,o.state=r,o.postmsg=a,o.realtimeStates=i,o}return r.d(e,t),e.prototype.initialize=function(e,n,r){var a=this,s=t.prototype.initialize.call(this,e,n,r),c=this.getStageDrag(n).pipe(Object(i.a)((function(t){return a.updatePan(t.nativeEvent.movementX,t.nativeEvent.movementY)}))),u=this.getStageMouseDown(e).pipe(Object(i.a)((function(t){a.hideComments()}))),d=this.getShapeTouch().pipe(Object(i.a)((function(t){a.postmsg.sendToParent("shape:touch",{shapeId:t.currentTarget.name})}))),f=this.interactionCanvas.canvas,g=Object(p.a)(f,"mousemove").pipe(Object(m.lodashThrottle)(200,{leading:!0,trailing:!0}),Object(i.a)((function(t){var e=a.vToDcoordinate.x(t.x),n=a.vToDcoordinate.y(t.y),r=JSON.stringify([e,n]);a.realtimeStates.set("pointer",r)})),Object(o.a)((function(t){return Object(l.b)()})));return Object(h.a)(s,d,c,u,g)},e.prototype.getStageMouseDown=function(t){return Object(p.a)(t,"stagemousedown")},e.prototype.hideComments=function(){this.state.set("CommentThreadData",{visible:!1})},e.prototype.getCursor=function(){var t=this;return this.pointerMove().pipe(Object(s.a)(100),Object(c.a)({x:this.interactionCanvas.getMouseX(),y:this.interactionCanvas.getMouseY()}),Object(u.a)((function(e){var n=t.getObjectsUnderPoint(e).filter((function(t){return t instanceof a.b}));return t.getCursorByContext(n,[])})),Object(d.a)((function(t,e){return t.cursor===e.cursor&&t.tail===e.tail})))},Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"move",tail:null,type:"css"}},enumerable:!0,configurable:!0}),e.prototype.shapeTouched=function(t){},e}(f.a));Object.defineProperty(g,"name",{value:"ViewerInteractionHandler"})},etrl:function(t,e,n){var r,a,i;a=[],void 0===(i="function"==typeof(r=function(){"use strict";function e(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){i(r.response,e,n)},r.onerror=function(){console.error("could not download file")},r.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,i=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(t,i,o){var s=a.URL||a.webkitURL,c=document.createElement("a");i=i||t.name||"download",c.download=i,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?r(c):n(c.href)?e(t,i,o):r(c,c.target="_blank")):(c.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){r(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,a,i){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,i),a);else if(n(t))e(t,a,i);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){r(o)}))}}:function(t,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,r);var o="application/octet-stream"===t.type,s=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&s)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},u.readAsDataURL(t)}else{var d=a.URL||a.webkitURL,p=d.createObjectURL(t);i?i.location=p:location.href=p,i=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});a.saveAs=i.saveAs=i,t.exports=i})?r.apply(e,a):r)||(t.exports=i)},flPR:function(t,e,n){"use strict";n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return b}));var r=n("D57K"),a=n("5xGT"),i=n("iUUs"),o=n("gQst"),s=n("wk5G"),c=n("ZJHl"),u=n("12aA"),d=n("Jg5f"),p=n("cGAd"),l=n("hOK2"),h=n("AouM"),f=n("R+ki"),m=n("W/Ou");function g(){return function(t){}}var b=function(){function t(t){this.state=t,this.subs=[]}return t.prototype.add=function(){var t=this.createAddSource().pipe(Object(c.a)());return this.subs.push(t.connect()),t},t.prototype.remove=function(){var t=this.createRemoveSource().pipe(Object(c.a)());return this.subs.push(t.connect()),t},t.prototype.change=function(){var t=this.createChangeSource().pipe(Object(c.a)());return this.subs.push(t.connect()),t},t.prototype.destroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe();this.indicatorLayer=void 0},t.prototype.duringInteractions=function(t,e){return Object(o.a)(this.duringSelectionInteraction(t,e),this.duringPan(t,e),this.duringTextEdit(t,e))},t.prototype.duringSelectionInteraction=function(t,e){return Object(o.a)(Object(i.a)(this.indicatorLayer,s.b.interactionStart).pipe(Object(u.a)(e)),Object(o.a)(Object(i.a)(this.indicatorLayer,s.b.interactionEnd),Object(i.a)(this.indicatorLayer,s.b.interactionCancel)).pipe(Object(u.a)(t)))},t.prototype.duringTextEdit=function(t,e){return this.state.changes("EditingText").pipe(Object(d.a)((function(n){return!1===n.open?t:e})))},t.prototype.duringPan=function(t,e){var n=this.state.changes("DiagramPan").pipe(Object(p.a)(1));return n.pipe(Object(l.a)(200),Object(h.a)((function(){return n.pipe(Object(f.a)(100),Object(u.a)(t),Object(m.a)(e))})))},t}();!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t)}(a.fb)},hSRu:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("Jg5f"),a=n("LiEJ"),i=n("d9YI"),o=n("fQLH"),s=(n("NNJu"),function(){function t(){this._data=new a.a(null),this.change=new o.a}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data.value},set:function(t){this._data.next(t)},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){this.data=t},t.prototype.setProperties=function(t){this.props=t},t.prototype.ngAfterViewInit=function(){var t=this;this.absDropdown.changed.subscribe((function(e){var n=t.data.value.find((function(t){return t.id===e[0]}));t.change.next(n)}))},t.prototype.select=function(t){},t.prototype.apply=function(){},t.prototype.applyAnimated=function(){return Object(i.b)()},Object.defineProperty(t.prototype,"dropdownType",{get:function(){var t=this.data.value.find((function(t){return t.selected}));return t?t.buttonIcon?"icon":"text":this.props.icon?"icon":"text"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultItems",{get:function(){return this._data.pipe(Object(r.a)((function(t){return t.value.filter((function(t){return!t.custom}))})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"customItems",{get:function(){return this._data.pipe(Object(r.a)((function(t){return t.value.filter((function(t){return t.custom}))})))},enumerable:!0,configurable:!0}),t}())},ljsB:function(t,e,n){"use strict";var r=n("D57K"),a=n("5xGT"),i=function(t){function e(){return t.call(this)||this}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{link:!0}},enumerable:!0,configurable:!0}),e.prototype.execute=function(){return window.open(this.data.link,"_blank"),!0},e=r.c([Object(a.l)(),r.f("design:paramtypes",[])],e)}(a.a);Object.defineProperty(i,"name",{value:"HyperlinkNavigate"});var o=n("S83/"),s=n("h1tj"),c=n("Jg5f"),u=function(t){function e(e){var n=t.call(this)||this;return n.state=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{x:!0,y:!0,dx:!1,dy:!1,currentX:!1,currentY:!1,animate:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IStateChangeCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return{DiagramPan:this.data.panStateData}},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this.state.get("DiagramPan");this.data.currentX=t.x,this.data.currentY=t.y,this.calculateXY(),!1===this.data.animate?this.data.panStateData=this.extractStateData(this.data):this.data.panStateData=this.simulateAnimation()},e.prototype.calculateXY=function(){void 0!==this.data.dx&&(this.data.x=this.data.currentX+this.data.dx),void 0!==this.data.dy&&(this.data.y=this.data.currentY+this.data.dy)},e.prototype.simulateAnimation=function(){var t=this;return o.a.simulate({x:this.data.currentX,y:this.data.currentY}).to({x:this.data.x,y:this.data.y},300,s.Ease.sineOut).changes().pipe(Object(c.a)((function(e){return t.extractStateData({x:e.x,y:e.y})})))},e.prototype.extractStateData=function(t){var e=t.x,n=t.y;return new s.Point(e,n)},e.prototype.execute=function(){return!0},e=r.c([Object(a.l)(),r.f("design:paramtypes",[a.fb])],e)}(a.a);Object.defineProperty(u,"name",{value:"PanDiagram"});var d=function(t){function e(e){var n=t.call(this)||this;return n.state=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{level:!0,currentLevel:!1,toX:!1,toY:!1,toCenter:!1,currentPan:!1,delta:!1,animate:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IStateChangeCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return this.data.panStateData?{DiagramZoomLevel:this.data.zoomStateData,DiagramPan:this.data.panStateData}:{DiagramZoomLevel:this.data.zoomStateData}},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){this.setZoomLevel(),this.setPan();var t=void 0!==this.data.toX&&void 0!==this.data.toY;if(!1===this.data.animate)this.data.zoomStateData=this.data.level,t&&(this.data.panStateData=this.getPan());else{var e=this.simulateAnimation();this.data.zoomStateData=e.pipe(Object(c.a)((function(t){return t.level}))),t&&(this.data.panStateData=e.pipe(Object(c.a)((function(t){return new s.Point(t.x,t.y)}))))}},e.prototype.getPan=function(){var t=this.data.level/this.data.currentLevel,e=(this.data.currentPan.x-this.data.toX)*t+this.data.toX,n=(this.data.currentPan.y-this.data.toY)*t+this.data.toY;return new s.Point(e,n)},e.prototype.setPan=function(){this.data.currentPan=this.state.get("DiagramPan");var t=this.state.get("DiagramViewPort");this.data.toCenter&&(this.data.toX=t.centerX,this.data.toY=t.centerY)},e.prototype.setZoomLevel=function(){this.data.currentLevel=this.state.get("DiagramZoomLevel"),!this.data.level&&this.data.delta>0&&(this.data.level=this.data.currentLevel*this.data.delta)},e.prototype.simulateAnimation=function(){var t=this.getPan();return o.a.simulate({level:this.data.currentLevel,x:this.data.currentPan.x,y:this.data.currentPan.y}).to({level:this.data.level,x:t.x,y:t.y},300,s.Ease.sineOut).changes()},e.prototype.execute=function(){return!0},e=r.c([Object(a.l)(),r.f("design:paramtypes",[a.fb])],e)}(a.a);Object.defineProperty(d,"name",{value:"ZoomDiagram"});var p=n("QoSw"),l=n("w1VY"),h=function(t){function e(e,n,r){var a=t.call(this)||this;return a.state=e,a.ll=n,a.diagramToViewPort=r,a}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{coordinates:!1,shapeIds:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IStateChangeCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return{DiagramPan:this.data.panStateData}},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){this.data.shapeIds&&this.data.shapeIds[0]?this.data.panStateData=this.panToShape(this.data.shapeIds[0]):this.data.coordinates&&(this.data.panStateData=this.calculatePan(this.data.coordinates))},Object.defineProperty(e.prototype,"locator",{get:function(){return this.ll.forCurrent(!0)},enumerable:!0,configurable:!0}),e.prototype.panToShape=function(t){var e=this;return this.locator.getShapeOnce(t).pipe(Object(c.a)((function(t){var n=t.bounds,r={x:n.centerX,y:n.centerY};return e.calculatePan(r)})))},e.prototype.calculatePan=function(t){var e=this.state.get("DiagramViewPort"),n=this.diagramToViewPort.x(t.x),r=this.diagramToViewPort.y(t.y),a=this.state.get("DiagramPan");return{x:a.x-(n-e.centerX),y:a.y-(r-e.centerY)}},e.prototype.execute=function(){return!0},e=r.c([Object(a.l)(),r.f("design:paramtypes",[a.fb,p.a,l.a])],e)}(a.a);Object.defineProperty(h,"name",{value:"FocusToPoint"}),n.d(e,"a",(function(){return f}));var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.register=function(t){t.map(e.zoomDiagram).add(d),t.map(e.panDiagram).add(u),t.map(e.focusToPoint).add(h),t.map(e.hyperlinkNavigate).add(i),t.mapSequence(e.zoomAndPanDiagram).add(d).add(u,{transform:function(t){return{x:t.data[0].x,y:t.data[0].y}}})},e.zoomDiagram=new e("ZoomDiagram"),e.panDiagram=new e("PanDiagram"),e.zoomAndPanDiagram=new e("ZoomAndPanDiagram"),e.focusToPoint=new e("FocusToPoint"),e.hyperlinkNavigate=new e("HyperlinkNavigate"),e}(a.o)},lu3Q:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("nsO7"),a=function(){function t(){}return t.prototype.addCursors=function(t){this.cursors?this.cursors=Object(r.merge)(this.cursors,t):this.cursors=t},t.prototype.getCursorCSS=function(t){var e,n;if(t.tail){var r=this.getCompactCursor(this.getCursor(t.cursor||"normal"),this.getTail(t.tail));e=r.content,n=r.origin}else{if(!t.cursor||t.tail)throw new Error("At least one of cursor or tail should be dfiend to generate the cursor CSS.");e=this.getCursor(t.cursor),n=this.getSvgData(e).origin}return("url('data:image/svg+xml;utf8,"+e+"') "+n.x+" "+n.y+", auto").replace(/\n|\r/g,"")},t.prototype.getCursorIcon=function(t){return"url("+this.getCursor(t.cursor)+"), auto"},t.prototype.getCursor=function(t){if(this.cursors.cursors[t])return this.cursors.cursors[t];throw new Error(t+" cursor is not found in the cursors ICursorMap")},t.prototype.getTail=function(t){if(this.cursors.tails[t])return this.cursors.tails[t];throw new Error(t+" cursor tail is not found in the cursors ICursorMap")},t.prototype.getCompactCursor=function(t,e){var n=this.getSvgData(t),r=this.getSvgData(e);return{content:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+(n.width+r.width)+'" height="'+(n.height+r.height)+'" ><g>'+n.content+'</g><g transform="translate('+n.width+" "+n.height+')">'+r.content+"</g></svg>",origin:n.origin}},t.prototype.getSvgData=function(t){var e=document.createElement("div");e.innerHTML=t;var n=e.querySelector("svg");return{content:n.innerHTML,width:Number(n.getAttribute("width")),height:Number(n.getAttribute("height")),origin:{x:Number(n.getAttribute("data-ox")||0),y:Number(n.getAttribute("data-oy")||0)}}},t}()},myrl:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("TQyE"),a=n("fQLH"),i=n("LiEJ"),o=n("d9YI"),s=n("nsO7"),c=function(){function t(t,e){this.resolver=t,this.injector=e,this.currentColorPickerComponents={},this.currentDataItemIds=[],this.componentRefreshRequired=!1,this.colorPickerSubscriptions=[],this._change=new a.a,this.valueSource=new i.a("")}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"change",{get:function(){return this._change},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){var e=t.map((function(t){return t.id}));this.currentDataItemIds.length>0?Object(s.isEqual)(this.currentDataItemIds.sort(),e.sort())?this.componentRefreshRequired=!1:(this.componentRefreshRequired=!0,this.currentDataItemIds=e):(this.currentDataItemIds=e,this.componentRefreshRequired=!0),this._data=t},t.prototype.setProperties=function(t){this._props=t},t.prototype.apply=function(){var t=this;this.componentRefreshRequired?(this.currentColorPickerComponents={},this.colorPickerSubscriptions.forEach((function(t){t.unsubscribe()})),this.colorPickerSubscriptions=[],this.singleColorPickerSection.clear(),this._data.forEach((function(e){var n=t.getColorPicker(e);n.instance.apply(),n.changeDetectorRef.markForCheck();var r=n.instance.change.subscribe((function(n){t._change.next({item:e,change:n})}));t.colorPickerSubscriptions.push(r)}))):this._data.forEach((function(e){t.getColorPicker(e).instance.apply()}))},t.prototype.applyAnimated=function(){return this.apply(),Object(o.b)()},t.prototype.createColorPicker=function(t){var e=this.resolver.resolveComponentFactory(r.a);return this.singleColorPickerSection.createComponent(e)},t.prototype.getColorPicker=function(t){this.currentColorPickerComponents[t.id]||(this.currentColorPickerComponents[t.id]=this.createColorPicker(t.id));var e=this.currentColorPickerComponents[t.id];return e.instance.setProperties({label:t.label}),e.instance.setData({value:t.style.fillColor?t.style.fillColor:t.style.lineColor}),e},t}()},"pt/I":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("D57K"),a=n("gQst"),i=n("iUUs"),o=n("U3QC"),s=n("4HYP"),c=n("AouM"),u=n("mhnT"),d=n("z5yO"),p=n("LLEj"),l=n("O6K7"),h=n("5xGT"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"comment",tail:null,type:"cur",viewingArea:"app"}},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e,n,r){var i=this,s=t.prototype.initialize.call(this,e,n,r),c=this.getStagePressUp(this.gridCanvas).pipe(Object(o.a)((function(t){return i.addComment(t)}))),u=this.getClickOnShape().pipe(Object(o.a)((function(t){return i.addComment(t)})));return Object(a.a)(s,c,u)},e.prototype.getClickOnShape=function(){var t=this;return this.getShapes().pipe(Object(s.a)((function(e){return Object(i.a)(e,"mousedown").pipe(Object(c.a)((function(){return Object(i.a)(e,"pressup").pipe(Object(u.a)(Object(i.a)(e,"pressmove")))})),Object(u.a)(Object(i.a)(t.diagramCanvas,"childRemoved").pipe(Object(d.a)((function(t){return t.child===e})))))})))},e.prototype.addComment=function(t){h.hb.track("canvas.comment.add.canvas.click");var e=new l.a(l.b.CreateComment,t);this.interactionCanvas.dispatchEvent(e)},e}(p.a)},qMyy:function(t,e,n){"use strict";var r=n("D57K"),a=n("Jzy8"),i=n("5xGT"),o=n("xnGY"),s=n("hX56"),c=n("G2Mx"),u=n("z5yO"),d=n("AouM"),p=n("oyCe"),l=function(t){function e(e,n){var r=t.call(this)||this;return r.modelSubManager=e,r.dataStore=n,r}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){var t=this;return this.dataStore.findOneRaw(p.a,{id:this.resourceId}).pipe(Object(c.a)(1),Object(u.a)((function(t){return t&&t.project&&"home"!==t.project})),Object(d.a)((function(e){return t.modelSubManager.start(a.o,e.project)})))},e=r.c([Object(i.l)(),r.f("design:paramtypes",[o.d,s.b])],e)}(i.a);Object.defineProperty(l,"name",{value:"StartDiagramProjectSubscription"});var h=n("ktZS"),f=n("981U"),m=n("U3QC"),g=function(t){function e(e,n){var r=t.call(this,n)||this;return r.modelSubManager=e,r.router=n,r}return r.d(e,t),e.prototype.execute=function(){var t=this;return this.resultData=this.data,this.modelSubManager.start(h.a,this.data.status.input.resourceId).pipe(Object(d.a)((function(t){return t.status})),Object(u.a)((function(t){return t.subStatus!==o.e.created})),Object(c.a)(1),Object(m.a)((function(e){t.navigateToRoute(t.data.status),e.subStatus===o.e.errored&&t.log.error("There was an error starting the diagram subscription : "+e.error)})))},e=r.c([Object(i.l)(),r.f("design:paramtypes",[o.d,f.m])],e)}(i.e);Object.defineProperty(g,"name",{value:"StartDiagramSubscription"});var b=n("yn08"),y=n("C5+t"),v=function(t){function e(e){var n=t.call(this)||this;return n.state=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{status:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return i.h.get("DISABLE_WEBSOCKET_CONNECTION")?["IStateChangeCommand"]:["IStateChangeCommand","IMessageCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return this.data},enumerable:!0,configurable:!0}),e.prototype.execute=function(){var t=this,e=this.data.status.input.action;return this.data={Realtime:{action:""}},e===b.a.Edit&&(this.data.Realtime.action="ACTIVITIES.EDITING"),e===b.a.View&&(this.data.Realtime.action="ACTIVITIES.VIEWING"),this.state.getShared().forEach((function(e){return t.data[e]=t.state.get(e)})),!0},e=r.c([Object(i.l)(),r.f("design:paramtypes",[i.fb])],e)}(y.b);Object.defineProperty(v,"name",{value:"BeginStateSync"});var O=n("d62g"),j=n("gQst"),S=n("8Fqk"),C=n("d9YI"),I=n("4y1S"),D=function(t){function e(e,n){var r=t.call(this)||this;return r.dataStore=e,r.modelSubManager=n,r}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{collabs:!0,diagramId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){this.data.collabs.forEach((function(t){t.addedStatus="pending",t.email=t.email.toLowerCase()}))},e.prototype.execute=function(){return this.dataStore.getModelStore(a.g).storageMergeCollabs(this.data.diagramId,this.data.collabs)},e.prototype.executeResult=function(t){var e=this,n=this.dataStore.getModelStore(a.g),i=[],s=t.collabs;return s.forEach((function(t,n){t&&(i.push(e.modelSubManager.start(I.i,t.id).pipe(Object(d.a)((function(t){return t.status})),Object(u.a)((function(t){return t.subStatus!==o.e.created})),Object(c.a)(1))),e.data&&(s[n].email=e.data.collabs[n].email))})),s.length>0?Object(O.a)(j.a.apply(void 0,r.j(i)),Object(S.a)((function(){return n.storageMergeCollabs(e.resourceId,s.filter((function(t){return null!==t})))})),Object(S.a)((function(){return e.removePendingCollabs()}))):Object(C.b)()},e.prototype.removePendingCollabs=function(){return this.dataStore.getModelStore(a.g).storageFilterCollabs(this.resourceId,(function(t){return"pending"===t.addedStatus}))},e.prototype.revert=function(){return this.removePendingCollabs()},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b,o.d])],e)}(y.b);Object.defineProperty(D,"name",{value:"AddDiagramCollaborators"});var x=n("pN2L"),P=n("Jg5f"),w=function(t){function e(e){var n=t.call(this)||this;return n.dataStore=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{collabs:!0,diagramId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.previousData={},this.dataStore.getModelStore(a.g).getCollabs(this.data.diagramId).pipe(Object(m.a)((function(e){t.previousData.collabs=e.filter((function(e){return-1!==t.data.collabs.map((function(t){return t.id})).indexOf(e.id)}))})))},e.prototype.execute=function(){var t=this,e=this.dataStore.getModelStore(a.g);return Object(x.a)(this.previousData.collabs).pipe(Object(P.a)((function(e){var n=[];return t.data.collabs.forEach((function(t){var r=e.filter((function(e){return e.id===t.id}))[0];r.role=t.role,n.push(r)})),n})),Object(d.a)((function(n){return e.storageMergeCollabs(t.data.diagramId,n)})))},e.prototype.executeResult=function(t){return this.dataStore.getModelStore(a.g).storageMergeCollabs(this.resourceId,t.collabs)},e.prototype.revert=function(){return this.dataStore.getModelStore(a.g).storageMergeCollabs(this.data.diagramId,this.previousData.collabs)},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b])],e)}(y.b);Object.defineProperty(w,"name",{value:"ChangeDiagramCollaborators"});var T=function(t){function e(e,n){var r=t.call(this)||this;return r.dataStore=e,r.modelSubManager=n,r}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{diagramId:!0,collabIds:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.previousData={},this.dataStore.getModelStore(a.g).getCollabs(this.data.diagramId).pipe(Object(m.a)((function(e){t.previousData.collabs=e.filter((function(e){return-1!==t.data.collabIds.indexOf(e.id)}))})))},e.prototype.execute=function(){var t=this;return this.dataStore.getModelStore(a.g).storageFilterCollabs(this.data.diagramId,(function(e){return t.data.collabIds.indexOf(e.id)>-1}))},e.prototype.executeResult=function(t){var e=this.dataStore.getModelStore(a.g),n=[];this.previousData&&(n=this.previousData.collabs.filter((function(e){return-1===t.collabIds.indexOf(e.id)})));var r=Object(C.b)();n.length>0&&(r=e.storageMergeCollabs(this.data.diagramId,n));var i=e.storageFilterCollabs(this.resourceId,(function(e){return t.collabIds.indexOf(e.id)>-1})),o=this.stopSubscriptions(t.collabIds);return Object(j.a)(r,i,o)},e.prototype.stopSubscriptions=function(t){var e=this;return Object(x.a)(t).pipe(Object(d.a)((function(t){var n=[];return t.forEach((function(t){t&&n.push(e.modelSubManager.stop(t))})),j.a.apply(void 0,r.j(n))})))},e.prototype.revert=function(){return this.dataStore.getModelStore(a.g).storageMergeCollabs(this.data.diagramId,this.previousData.collabs)},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b,o.d])],e)}(y.b);Object.defineProperty(T,"name",{value:"RemoveDiagramCollaborators"});var E=function(t){function e(e){var n=t.call(this)||this;return n.dataStore=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{privacy:!0,diagramId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.previousData={},this.dataStore.getModelStore(a.g).getPrivacy(this.data.diagramId).pipe(Object(m.a)((function(e){return t.previousData.privacy=e})))},e.prototype.execute=function(){var t=this,e=this.dataStore.getModelStore(a.g);return Object(x.a)(this.previousData.privacy).pipe(Object(P.a)((function(e){return e.role=t.data.privacy.role,e.level=t.data.privacy.level,e})),Object(d.a)((function(n){return e.storgaeUpdatePrivacy(t.data.diagramId,n)})))},e.prototype.executeResult=function(t){return this.dataStore.getModelStore(a.g).storgaeUpdatePrivacy(this.resourceId,t.privacy)},e.prototype.revert=function(){return this.dataStore.getModelStore(a.g).storgaeUpdatePrivacy(this.data.diagramId,this.previousData.privacy)},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b])],e)}(y.b);Object.defineProperty(E,"name",{value:"ChangeDiagramPrivacy"});var A=function(t){function e(e,n){var r=t.call(this)||this;return r.modelSubManager=e,r.dataStore=n,r}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){var t=this;return this.dataStore.findOneRaw(p.a,{id:this.resourceId}).pipe(Object(c.a)(1),Object(u.a)((function(t){return!!(t&&t.collabs&&t.collabs.length>0)})),Object(d.a)((function(e){return j.a.apply(void 0,r.j(e.collabs.map((function(e){return t.modelSubManager.start(I.i,e.id)}))))})))},e=r.c([Object(i.l)(),r.f("design:paramtypes",[o.d,s.b])],e)}(i.a);Object.defineProperty(A,"name",{value:"StartDiagramCollabSubscriptions"});var M=n("zZcu"),R=n("QoSw"),k=n("NNJu"),F=n("iJR/"),L=n("etrl"),N=n.n(L),_=n("19Zn"),Y=function(t){function e(e,n,r,a){var i=t.call(this)||this;return i.ll=e,i.resources=n,i.notifierController=r,i.translate=a,i.maxClientExportWidth=6e3,i.startExportNotificationId="IMAGE_EXPORT_STARTED",i.maxServerExportWidth=32e3,i}return r.d(e,t),e.prototype.prepareSvgData=function(){var t=this.ll.forCurrentObserver(this.eventData.scenario===i.p.PREVIEW),e=this.createDiagramSVGView(t);return t.pipe(Object(c.a)(1),Object(d.a)((function(t){return t.getDiagramOnce()})),Object(d.a)((function(t){return Object(O.a)(Object(S.a)((function(){return e.populateDiagram()})),Object(S.a)((function(){return e.toSvg().pipe(Object(c.a)(1),Object(P.a)((function(e){return{svg:e,name:t.name}})))})))})))},e.prototype.createDiagramSVGView=function(t){return new _.l(t,this.resources)},e.prototype.execute=function(){return this.triggerDownload()},e.prototype.triggerDownload=function(){if("file"===this.data.format){var t=new Blob([this.data.content],{type:this.data.type});return N()(t,this.data.name),Object(x.a)(!0)}if("blob"===this.data.format)return N()(this.data.content,this.data.name),Object(x.a)(!0)},e.prototype.showExportNotification=function(){var t={inputs:{heading:""+this.translate.instant("NOTIFICATIONS.IMAGE_EXPORT.START.HEADING"),description:""+this.translate.instant("NOTIFICATIONS.IMAGE_EXPORT.START.BODY"),type:k.b.Info,autoDismiss:!1,icon:"image"}};this.notifierController.show(this.startExportNotificationId,k.a,t)},e.prototype.showErrorNotification=function(){var t={inputs:{heading:""+this.translate.instant("NOTIFICATIONS.IMAGE_EXPORT.ERROR.HEADING"),description:""+this.translate.instant("NOTIFICATIONS.IMAGE_EXPORT.ERROR.BODY"),type:k.b.Error,autoDismiss:!0,dismissAfter:3e3}};this.notifierController.show("IMAGE_EXPORT_FAILED",k.a,t)},e.prototype.hideExportNotification=function(){this.notifierController.hide(this.startExportNotificationId)},e.prototype.fetchDiagramFromServer=function(t,e){var n=Math.min(this.maxServerExportWidth,Math.round(e));return this.prepareSvgData().pipe(Object(d.a)((function(e){return Object(F.a)(fetch(i.h.get("SVG_TO_RASTER_URL"),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({type:t,width:n,svg:e.svg})}))})),Object(d.a)((function(t){return Object(F.a)(t.blob())})))},e=r.c([Object(i.l)(),r.f("design:paramtypes",[R.a,i.F,i.Q,M.k])],e)}(i.a);Object.defineProperty(Y,"name",{value:"AbstractDiagramExportCommand"});var U=function(t){function e(e,n,r,a,i){var o=t.call(this,e,r,a,i)||this;return o.state=n,o}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){var e=this;return this.ll.forCurrent(this.eventData.scenario===i.p.PREVIEW).getDiagramOnce().pipe(Object(d.a)((function(t){var n=e.state.get("DiagramCanvas"),r=t.getBounds(),a=r.width+40,i=r.height+40;if(a>e.maxClientExportWidth)return e.showExportNotification(),e.fetchDiagramFromServer("png",2*a).pipe(Object(P.a)((function(e){return{name:t.name,blob:e}})));n.cache(r.x-20,r.y-20,a,i,2);var o=n.getCacheDataURL();return n.uncache(),Object(x.a)({name:t.name,blob:o})})),Object(m.a)((function(t){e.data={content:t.blob,name:t.name+".png",type:"image/png",format:"blob"}})),Object(d.a)((function(){return t.prototype.execute.call(e)}))).subscribe({complete:function(){return e.hideExportNotification()},error:function(){e.hideExportNotification(),e.showErrorNotification()}}),Object(x.a)({})},e=r.c([Object(i.l)(),r.f("design:paramtypes",[R.a,i.fb,i.F,i.Q,M.k])],e)}(Y);Object.defineProperty(U,"name",{value:"ExportAsPng"});var X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.prepareSvgData().pipe(Object(m.a)((function(e){return t.data={content:e.svg,name:e.name+".svg",type:"image/svg+xml",format:"file"}})))},e=r.c([Object(i.l)()],e)}(Y);Object.defineProperty(X,"name",{value:"ExportAsSvg"});var G=n("P1E4"),B=function(t){function e(e,n,r,a){var i=t.call(this,n,r)||this;return i.state=e,i.dataStore=n,i.modelSubManager=r,i.router=a,i}return r.d(e,t),e.prototype.executeResult=function(e){var n=this;return t.prototype.executeResult.call(this,e).pipe(Object(m.a)((function(){n.resourceId===n.state.get("CurrentDiagram")&&n.router.navigateByUrl("../manage/recent")})))},e=r.c([Object(i.l)(),r.f("design:paramtypes",[i.fb,s.b,o.d,f.m])],e)}(a.a);Object.defineProperty(B,"name",{value:"DeleteDiagram"});var W=n("d9KY"),z=function(t){function e(e,n,r,a,i){var o=t.call(this,e,r,a,i)||this;return o.state=n,o}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){var e=this;return this.ll.forCurrent(this.eventData.scenario===i.p.PREVIEW).getDiagramOnce().pipe(Object(d.a)((function(t){var n=e.state.get("DiagramCanvas"),r=t.getBounds(),a=r.width+40,i=r.height+40;if(a>e.maxClientExportWidth)return e.showExportNotification(),e.fetchDiagramFromServer("jpg",2*a).pipe(Object(P.a)((function(e){return{name:t.name,blob:e}})));n.cache(r.x-20,r.y-20,a,i,2);var o=n.cacheCanvas,s=o.cloneNode(!0),c=s.getContext("2d");c.fillStyle="#FFF",c.fillRect(0,0,s.width,s.height),c.drawImage(o,0,0);var u=s.toDataURL("image/jpg",1);return n.uncache(),Object(x.a)({name:t.name,blob:u})})),Object(m.a)((function(t){e.data={content:t.blob,name:t.name+".jpg",type:"image/jpg",format:"blob"}})),Object(d.a)((function(){return t.prototype.execute.call(e)}))).subscribe({complete:function(){return e.hideExportNotification()},error:function(){e.hideExportNotification(),e.showErrorNotification()}}),Object(x.a)({})},e=r.c([Object(i.l)(),r.f("design:paramtypes",[R.a,i.fb,i.F,i.Q,M.k])],e)}(Y);Object.defineProperty(z,"name",{value:"ExportAsJpeg"});var q=n("fqe/"),Q=function(t){function e(e){var n=t.call(this)||this;return n.auth=e,n}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["IGraphqlRestCommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){return Object(C.b)()},e.prototype.prepareData=function(){var t='{\n            document(id:"'+this.data.resourceId+'"){\n            image{\n              svg\n            }\n        }}';this.data.query=t,this.data.auth=this.auth.token},Object.defineProperty(e.prototype,"httpUrl",{get:function(){return i.h.get("GRAPHQL_API_BASE_URL")},enumerable:!0,configurable:!0}),e=r.c([Object(i.l)(),r.f("design:paramtypes",[q.a])],e)}(i.d);Object.defineProperty(Q,"name",{value:"FetchEmbedImageUrl"});var H=n("g3Dv"),V=n("Wpmq"),K=n("3+4Q"),J=n("3riI"),$=function(t){function e(e,n,r,a,i,o,s){var c=t.call(this)||this;return c.userLocator=e,c.notifierController=n,c.translate=r,c.ll=a,c.v2d=i,c.dataStore=o,c.state=s,c}var n;return r.d(e,t),n=e,Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),e.handleNotificationClick=function(t,e,n){if(t.parentId)n.findOneLatest(K.a,{id:t.parentId}).pipe(Object(m.a)((function(t){var n={visible:!0,threadId:t.id,comments:[t]};e.set("CommentThreadData",n)}))).subscribe();else{var r={visible:!0,threadId:t.id,comments:[t]};e.set("CommentThreadData",r)}},Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.data.comment.diagramId=this.resourceId,this.data.comment.userId=this.state.get("CurrentUser"),this.data.comment.added=Date.now(),this.data.comment.parentId?(delete this.data.comment.shapeId,delete this.data.comment.locOnDiagram,Object(C.b)()):this.data.comment.shapeId?this.ll.forCurrent(!1).getShapeOnce(this.data.comment.shapeId).pipe(Object(m.a)((function(e){if(e.type!==H.m.Connector){var n=e.getPositionOnShape(t.data.comment.locOnDiagram,5);t.data.comment.locOnShape=n}else delete t.data.comment.shapeId}))):Object(C.b)()},e.prototype.execute=function(){var t=this;return Object(O.a)(this.dataStore.insert(K.a,this.data.comment),Object(S.a)((function(){return t.dataStore.findOne(K.a,t.data.comment).pipe(Object(c.a)(1),Object(m.a)((function(e){if(!e.parentId){var n={visible:!0,threadId:e.id,comments:[e]};t.state.set("CommentThreadData",n)}})))})))},e.prototype.executeResult=function(){var t=r.a({},this.resultData.comment,{diagramId:this.resourceId,comitted:!0});return Object(J.b)(this.handleNotification(),this.dataStore.insert(K.a,t))},e.prototype.handleNotification=function(){var t=this;return this.state.get("CurrentUser")!==this.resultData.comment.userId&&this.state.get("CurrentDiagram")===this.resultData.comment.diagramId?this.userLocator.getUserInfo(this.resultData.comment.userId).pipe(Object(c.a)(1),Object(m.a)((function(e){var r=t.resultData.comment.parentId?"REPLIED":"ADDED",a={inputs:{heading:e.firstName+" "+t.translate.instant("NOTIFICATIONS.COMMENT."+r),description:""+t.resultData.comment.comment,user:e,type:k.b.Info,notificationAction:{action:n.handleNotificationClick,args:[t.resultData.comment,t.state,t.dataStore]},autoDismiss:!0,dismissAfter:3e3}};t.notifierController.show("COMMENT_ADDED",k.a,a)}))):Object(x.a)({})},e=n=r.c([Object(i.l)(),r.f("design:paramtypes",[I.j,i.Q,M.k,R.a,V.a,s.b,i.fb])],e)}(y.b);Object.defineProperty($,"name",{value:"AddComment"});var Z=function(t){function e(e){var n=t.call(this)||this;return n.dataStore=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{commentId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.previousData={},this.dataStore.findOne(K.a,{id:this.data.commentId,diagramId:this.resourceId}).pipe(Object(c.a)(1),Object(m.a)((function(e){return t.previousData.comment=e.comment})))},e.prototype.execute=function(){return this.dataStore.update(K.a,{id:this.data.commentId,diagramId:this.resourceId},{$set:{deleted:(new Date).getTime(),comitted:!1},$unset:{comment:""}})},e.prototype.executeResult=function(t){return this.dataStore.update(K.a,{id:this.resultData.comment.id,diagramId:this.resourceId},{$set:{deleted:t.comment.deleted,comitted:!0},$unset:{comment:""}})},e.prototype.revert=function(){return this.dataStore.update(K.a,{id:this.data.commentId,diagramId:this.resourceId},{$set:{comment:this.previousData.comment},$unset:{deleted:""}})},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b])],e)}(y.b);Object.defineProperty(Z,"name",{value:"DeleteComment"});var tt=n("zd2y"),et=function(t){function e(e,n){var r=t.call(this)||this;return r.resourceId=e,r.datastore=n,r}return r.d(e,t),Object.defineProperty(e.prototype,"subscription",{get:function(){return"Comment"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modelType",{get:function(){return K.a},enumerable:!0,configurable:!0}),e.prototype.getLatestSyncedTime=function(){var t={id:this.resourceId};return this.datastore.findOneLatest(K.a,t,{sort:{lastUpdated:-1}}).pipe(Object(P.a)((function(t){return t?t.lastUpdated:null})))},e}(o.b),nt=function(t){function e(e,n){var r=t.call(this)||this;return r.commentSub=e,r.datastore=n,r}return r.d(e,t),e.prototype.execute=function(){var t=new et(this.resourceId,this.datastore);return this.commentSub.start(t),!0},e=r.c([Object(i.l)(),r.f("design:paramtypes",[tt.a,s.b])],e)}(i.a);Object.defineProperty(nt,"name",{value:"StartDiagramCommentSubscription"});var rt=function(t){function e(e,n,r,a,i){var o=t.call(this)||this;return o.userLocator=e,o.notifierController=n,o.translate=r,o.state=a,o.dataStore=i,o}var n;return r.d(e,t),n=e,e.handleNotificationClick=function(t,e,n){if(t.parentId)n.findOneLatest(K.a,{id:t.parentId}).pipe(Object(m.a)((function(t){var n={visible:!0,threadId:t.id,comments:[t]};e.set("CommentThreadData",n)}))).subscribe();else{var r={visible:!0,threadId:t.id,comments:[t]};e.set("CommentThreadData",r)}},Object.defineProperty(e,"dataDefinition",{get:function(){return{commentId:!0,userId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.execute=function(){return this.dataStore.update(K.a,{id:this.data.commentId,diagramId:this.resourceId},{$set:{resolved:(new Date).getTime(),resolvedBy:this.data.userId,comitted:!1}})},e.prototype.executeResult=function(t){return Object(J.b)(this.handleNotification(),this.dataStore.update(K.a,{id:this.resultData.comment.id,diagramId:this.resourceId},{$set:{resolved:this.resultData.comment.resolved,resolvedBy:this.resultData.comment.resolvedBy,comitted:!0}}))},e.prototype.handleNotification=function(){var t=this;return this.state.get("CurrentUser")!==this.resultData.comment.resolvedBy&&this.state.get("CurrentDiagram")===this.resultData.comment.diagramId?this.userLocator.getUserInfo(this.resultData.comment.resolvedBy).pipe(Object(c.a)(1),Object(m.a)((function(e){var r={inputs:{heading:""+e.firstName,description:""+t.translate.instant("NOTIFICATIONS.COMMENT.RESOLVED"),user:e,type:k.b.Info,notificationAction:{action:n.handleNotificationClick,args:[t.resultData.comment,t.state,t.dataStore]},autoDismiss:!0,dismissAfter:3e3}};t.notifierController.show("COMMENT_RESOLVED",k.a,r)}))):Object(x.a)({})},e.prototype.revert=function(){return this.dataStore.update(K.a,{id:this.data.commentId,diagramId:this.resourceId},{$unset:{resolved:"",resolvedBy:""}})},e=n=r.c([Object(i.l)(),r.f("design:paramtypes",[I.j,i.Q,M.k,i.fb,s.b])],e)}(y.b);Object.defineProperty(rt,"name",{value:"ResolveComment"});var at=function(t){function e(e,n){var r=t.call(this)||this;return r.ll=e,r.resources=n,r}return r.d(e,t),e.prototype.prepareData=function(){var t=this;this.data={};var e=this.ll.forCurrent(this.eventData.scenario===i.p.PREVIEW),n=this.createDiagramSVGView(e);return e.getDiagramOnce().pipe(Object(d.a)((function(e){return Object(O.a)(Object(S.a)((function(){return n.populateDiagram()})),Object(S.a)((function(){return n.toSvg().pipe(Object(c.a)(1),Object(m.a)((function(e){t.data.data=e})))})))})))},e.prototype.createDiagramSVGView=function(t){return new _.l(Object(x.a)(t),this.resources)},Object.defineProperty(e,"implements",{get:function(){return["IHttpCommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){return Object(C.b)()},Object.defineProperty(e,"resultType",{get:function(){return{result:Object}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"httpUrl",{get:function(){return i.h.get("PDF_EXPORT_URL")},enumerable:!0,configurable:!0}),e=r.c([Object(i.l)(),r.f("design:paramtypes",[R.a,i.F])],e)}(i.d);Object.defineProperty(at,"name",{value:"GeneratePdf"});var it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["ICommand"]},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.ll.forCurrent(this.eventData.scenario===i.p.PREVIEW).getDiagramOnce().pipe(Object(m.a)((function(e){t.data={content:t.data.data,name:e.name+".pdf",type:"application/pdf",format:"blob"}})))},e=r.c([Object(i.l)()],e)}(Y);Object.defineProperty(it,"name",{value:"ExportAsPdf"});var ot=function(t){function e(e){var n=t.call(this)||this;return n.state=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{state:!1,keyboardEvent:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IStateChangeCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return{MouseControlState:this.data.state}},enumerable:!0,configurable:!0}),e.prototype.execute=function(){if(!this.data)return!1;if(this.data.keyboardEvent&&"keydown"===this.data.keyboardEvent.type){var t=this.state.get("CommentThreadData");this.data.keyboardEvent.keyCode===H.f.C&&t&&!t.visible?(this.data={state:b.b.Comment},i.hb.track("right.comment.add.click",{value1Type:"trigger",value1:"c"})):this.data.keyboardEvent.keyCode===H.f.Space&&(this.data={state:b.b.Pan})}else this.data.keyboardEvent&&"keyup"===this.data.keyboardEvent.type&&(this.data={state:b.b.Normal});return!!this.data.state},e=r.c([Object(i.l)(),r.f("design:paramtypes",[i.fb])],e)}(i.a);Object.defineProperty(ot,"name",{value:"ChangeMouseControlState"});var st=function(t){function e(e){var n=t.call(this)||this;return n.dataStore=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{commentIds:!0,userId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.execute=function(){return this.dataStore.update(K.a,{id:{$in:this.data.commentIds},diagramId:this.resourceId},{$set:{seenBy:[this.data.userId],comitted:!1}})},e.prototype.executeResult=function(){return this.dataStore.update(K.a,{id:{$in:this.data.commentIds},diagramId:this.resourceId},{$set:{comitted:!0}})},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b])],e)}(y.b);Object.defineProperty(st,"name",{value:"MarkCommentSeen"});var ct=function(t){function e(e){var n=t.call(this)||this;return n.dataStore=e,n}return r.d(e,t),Object.defineProperty(e,"dataDefinition",{get:function(){return{commentId:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"implements",{get:function(){return["IMessageCommand","IDiagramCommand","ICollabCommand"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.prepareData=function(){var t=this;return this.previousData={},this.dataStore.findOne(K.a,{id:this.data.commentId,diagramId:this.resourceId}).pipe(Object(c.a)(1),Object(m.a)((function(e){return t.previousData.comment=e.comment})))},e.prototype.execute=function(){return this.dataStore.update(K.a,{id:this.data.commentId,diagramId:this.resourceId},{$set:{comment:this.data.comment,edited:(new Date).getTime(),comitted:!1}})},e.prototype.executeResult=function(t){return this.dataStore.update(K.a,{id:this.resultData.comment.id,diagramId:this.resourceId},{$set:{comment:t.comment.comment,edited:t.comment.edited,comitted:!0}})},e.prototype.revert=function(){return this.dataStore.update(K.a,{id:this.data.commentId,diagramId:this.resourceId},{$set:{comment:this.previousData.comment},$unset:{edited:""}})},e=r.c([Object(i.l)(),r.f("design:paramtypes",[s.b])],e)}(y.b);Object.defineProperty(ct,"name",{value:"EditComment"});var ut=function(t){function e(e){var n=t.call(this)||this;return n.auth=e,n}return r.d(e,t),Object.defineProperty(e,"implements",{get:function(){return["IGraphqlRestCommand"]},enumerable:!0,configurable:!0}),e.prototype.execute=function(){return Object(C.b)()},e.prototype.prepareData=function(){var t='mutation{\n            documentResetEmbed(id:"'+this.data.resourceId+'")\n        }';this.data.query=t,this.data.auth=this.auth.token},Object.defineProperty(e.prototype,"httpUrl",{get:function(){return i.h.get("GRAPHQL_API_BASE_URL")},enumerable:!0,configurable:!0}),e=r.c([Object(i.l)(),r.f("design:paramtypes",[q.a])],e)}(i.d);Object.defineProperty(ut,"name",{value:"ResetEmbedImageToken"}),n.d(e,"a",(function(){return dt}));var dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.register=function(t){t.mapSequence(e.startDiagramSubscription).add(g),t.mapSequence(e.startDiagramSubscriptionAndDeps).add(g).add(v,{alter:function(t){return!0}}).add(A).add(nt).add(l),t.mapSequence(e.addDiagramCollaborators).add(D),t.map(e.removeDiagramCollaborators).add(T),t.map(e.changeDiagramCollaborators).add(w),t.mapSequence(e.changeDiagramPrivacy).add(E),t.mapSequence(e.exportAsPng).add(U),t.mapSequence(e.exportAsJpeg).add(z),t.mapSequence(e.fetchEmbedImageUrl).add(Q),t.mapSequence(e.resetEmbedImageToken).add(ut),t.mapSequence(e.exportAsSvg).add(X),t.mapSequence(e.exportAsPdf).add(at).add(it),t.map(e.deleteDiagram).add(B),t.map(e.selectShapes).add(W.a),t.map(e.addComment).add($),t.map(e.editComment).add(ct),t.map(e.deleteComment).add(Z),t.map(e.resolveComment).add(rt),t.map(e.markCommentSeen).add(st),t.map(e.changeMouseControlState).add(ot)},e.startDiagramSubscription=new e("StartDiagramSubscription"),e.startDiagramSubscriptionAndDeps=new e("StartDiagramSubscriptionAndDeps"),e.addDiagramCollaborators=new e("AddDiagramCollaborators"),e.changeDiagramCollaborators=new e("ChangeDiagramCollaborators"),e.removeDiagramCollaborators=new e("RemoveDiagramCollaborators"),e.changeDiagramPrivacy=new e("ChangeDiagramPrivacy"),e.exportAsPng=new e("ExportAsPng"),e.fetchEmbedImageUrl=new e("FetchEmbedImageUrl"),e.resetEmbedImageToken=new e("ResetEmbedImageToken"),e.exportAsJpeg=new e("ExportAsJpeg"),e.exportAsSvg=new e("ExportAsSvg"),e.exportAsPdf=new e("ExportAsPdf"),e.selectShapes=new e("SelectShapes"),e.addComment=new e("AddComment"),e.editComment=new e("EditComment"),e.deleteComment=new e("DeleteComment"),e.resolveComment=new e("ResolveComment"),e.markCommentSeen=new e("MarkCommentSeen"),e.deleteDiagram=new G.a("DeleteDiagram"),e.changeMouseControlState=new e("ChangeMouseControlState"),e}(i.c)},sXdR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("nsO7"),a=n("LcNk");e.lodashThrottle=function(t,e){return void 0===e&&(e={leading:!0,trailing:!0}),function(n){return a.Observable.create((function(a){var i=r.throttle(a.next.bind(a),t,e),o=n.subscribe((function(t){return i(t)}),(function(t){return a.next(t)}),(function(){return a.complete()}));return function(){o.unsubscribe()}}))}}},wk5G:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var r,a=n("D57K"),i=n("h1tj");!function(t){t.interactionStart="interaction-start",t.interaction="interaction",t.interactionImmediate="interaction-immediate",t.interactionEnd="interaction-end",t.interactionCancel="interaction-cancel"}(r||(r={}));var o=function(t){function e(e,n,r,a,i){var o=t.call(this,e,!0,!0)||this;return o.type=e,o.handle=r,o.targetOver=a,o.relatedEvent=i,o.interactionName=n,o}return a.d(e,t),e}(i.Event)},yhNa:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("fQLH"),a=n("LiEJ"),i=n("d9YI"),o=function(){function t(){this._change=new r.a,this.valueSource=new a.a("")}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"change",{get:function(){return this._change.asObservable()},enumerable:!0,configurable:!0}),t.prototype.setData=function(t){this._data=t},t.prototype.setProperties=function(t){this._props=t},t.prototype.apply=function(){this.valueSource.next(this._data.value)},t.prototype.applyAnimated=function(){return this.apply(),Object(i.b)()},t}()},zd2y:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n("D57K"),a=(n("C5+t"),n("5xGT"),n("xnGY")),i=n("8Fqk"),o=n("d9YI"),s=n("cQOC"),c=n("G2Mx"),u=n("AouM"),d=function(t){function e(e,n,r,a,i){var o=t.call(this,e)||this;return o.logger=e,o.messageFactory=n,o.authentication=r,o.commandService=a,o.neutrinoConnection=i,o}return r.d(e,t),e.prototype.startSubscription=function(t){var e=this;return this.logger.debug("SubscriptionService: starting subscription: "+t.resourceId),Object(i.a)((function(){return t.getLatestSyncedTime().pipe(Object(c.a)(1))})).pipe(Object(u.a)((function(n){return e.sendSubStartRequest(t,n)})),Object(u.a)((function(n){return e.handleSubStartResponse(t,n)})))},e.prototype.closeSubscription=function(t){return this.logger.debug("SubscriptionService: closing subscription: "+t.resourceId),this.sendSubEndRequest(t)},e.prototype.sendSubStartRequest=function(t,e){var n=this.messageFactory.createSubscriptionMessage("start",t.subscription,t.resourceId);return n.authToken=this.authentication.token,n.payload=e?{latestCommentTimestamp:e}:{},this.neutrinoConnection.send(n)},e.prototype.sendSubEndRequest=function(t){var e=this.messageFactory.createSubscriptionMessage("end",t.subscription,t.resourceId);return e.authToken=this.authentication.token,e.payload={},this.neutrinoConnection.send(e)},e.prototype.handleSubStartResponse=function(t,e){var n=e.ppld,r=[];if(n.comments){var a={type:t.modelType,data:{model:n.comments}};r.push(this.commandService.collab("SubStoreModels",e.rid,null,a))}return r.length?Object(s.a)(r):Object(o.b)()},e}(a.c)}}]);
//# sourceMappingURL=1.603b2c2db73a49d4f1f9.js.map